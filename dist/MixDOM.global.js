!function(){'use strict';var e=require('data-signals');function t(e,t,n=0,o=!1,s=!1,r){const i=[];let a,d=[e],l=0;const c=e.boundary;for(;a=d[l];)if(l++,!a.boundary||null!==a.boundary.isMounted){if((!t||t[a.type])&&(!r||r(a))){const e=i.push(a);if(n&&e>=n)return i}a.boundary&&!o&&a.boundary!==c||('host'!==a.type||s)&&a.children[0]&&(d=a.children.concat(d.slice(l)),l=0)}return i}function n(e,t=!1,o=!1,s=0){let r=[];for(const i of e.children)if(i.domNode||o)switch(i.type){case'dom':if(r.push(i),s&&r.length>=s)return r;break;case'boundary':case'pass':case'host':if(!t)break;case'root':if(r=r.concat(n(i,t,o,s&&s-r.length)),s&&r.length>=s)return r.slice(0,s)}return r}function o(e,n,o=!1,s=!1){const r=t(e,{dom:!0},1,o,s,(e=>e.domNode&&e.domNode instanceof Element&&e.domNode.matches(n)))[0];return r&&r.domNode||null}function s(e,n,o=0,s=!1,r=!1){return t(e,{dom:!0},o,s,r,(e=>e.domNode&&e.domNode instanceof Element&&e.domNode.matches(n))).map((e=>e.domNode))}const r={style:!0,data:!0};function i(e,t){const n={};let o=!1;for(const s in e){void 0!==e[s]&&void 0===t[s]&&(n[s]=void 0,o=!0)}for(const s in t){const r=t[s];e[s]!==r&&(n[s]=r,o=!0)}return o?n:null}function a(t,n,o){var s;const r=!t||!n;for(const i in o){const a=o[i],d='number'==typeof a?a:null!==(s=e.CompareDataDepthEnum[a])&&void 0!==s?s:0;if(d<-1){if(-2===d)return!1}else{if(-2===d)return!1;if(r)return!t&&!n;if(0===d){if(t[i]!==n[i])return!1}else if(!e.areEqual(t[i],n[i],d))return!1}}return!0}function d(e,t){for(const n in r)if(e[n]){if(!t[n])return!1;const o=e[n],s=t[n];if(o!==s){for(const e in s)if(o[e]!==s[e])return!1;for(const e in o)if(void 0===s[e]&&void 0!==o[e])return!1}}else if(t[n])return!1;for(const n in t)if(e[n]!==t[n]&&!r[n])return!1;for(const n in e)if(void 0===t[n]&&void 0!==e[n]&&!r[n])return!1;return!0}function l(e,t){const n=t?Object.assign({},e):e;return n.class&&(n.className=n.className?n.class+' '+n.className:n.class),delete n.class,'string'==typeof n.style&&(n.style=c(n.style)),n}function c(e){const t=e.replace(/\/\*(.|\s)*?\*\//g,' ').replace(/\s+/g,' ').trim();if(!t)return{};const n={},o=t.split(';').map((e=>e.split(':').map((e=>e&&e.trim()))));for(const[e,t]of o)e&&(n[e.replace(/\W+\w/g,(e=>e.slice(-1).toUpperCase()))]=t);return n}function u(e,t,n=''){switch(typeof e){case'string':if(n)for(const o of e.split(n))o&&(t[o]=!0);else t[e]=!0;break;case'object':if(e.constructor===Object)for(const n in e)n&&e[n]&&(t[n]=!0);else for(const o of e)if(o&&'string'==typeof o)if(n)for(const e of o.split(n))e&&(t[e]=!0);else t[o]=!0}}function f(e,t){if((e=e||'')===(t=t||''))return null;const n=e.split(' '),o=t.split(' '),s={};let r=null;if(n)for(const e of n)!e||o&&-1!==o.indexOf(e)||(s[e]=r=!1);if(o)for(const e of o)!e||n&&-1!==n.indexOf(e)||(s[e]=r=!0);return null!==r?s:null}var h=(e,t)=>{var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n};const p={};function m(e,t=null,...n){const o=function(e){if('string'==typeof e)return'dom';const t=e.MIX_DOM_CLASS;if(!t)return'function'==typeof e?e.length>=2?'boundary':'spread':'';switch(t){case'Component':case'Remote':return'boundary';case'Fragment':case'Portal':case'Element':case'Host':return t.toLowerCase();default:return''}}(e);if(!o||t&&t._disable)return null;const s=[];let r=!1,i=0;for(const e of n){let t='string'==typeof e;if(e&&t&&r){s[i-1].domContent+=e;continue}const n=g(e);n&&(i=s.push(n),r=t)}if('spread'===o)return function(e,t,n){var o;const{_key:s,_disable:r}=t,i=h(t,['_key','_disable']);let a=g(e(i));if(!a)return null;const d={passes:[],withs:[]},l={MIX_DOM_DEF:'fragment',childDefs:[Object.assign({},a)],scopeType:'spread',spreadLinks:d,tag:null};null!=s&&(l.key=s);null!=r&&(l.disabled=r);let c,u=[l],f=!1,p=0;const m=!!n[0];for(;c=u[p];){if(p++,!c.childDefs[0])continue;let e=[];const t=c.childDefs;c.childDefs=[];for(const s of t){let t;if(s.spreadLinks){t=s,e=e.concat(s.spreadLinks.passes);for(const[e,t]of s.spreadLinks.withs){const n=e&&M(e,m);t.props.hasContent=!!n,'maybe'===n&&d.withs.push([e,t])}}else if('pass'!==s.MIX_DOM_DEF||s.getRemote){if(t=Object.assign({},s),e.push(t),'boundary'===s.MIX_DOM_DEF&&s.tag._WithContent&&!s.tag._WithContent.getRemote&&null==(null===(o=t.props)||void 0===o?void 0:o.hasContent)){const e=M(n,m);t.props=Object.assign({hasContent:!!e},t.props),'maybe'===e&&d.withs.push([n,t])}}else t={MIX_DOM_DEF:'fragment',tag:null,childDefs:[...n]},null!=s.key&&(t.key=s.key),f||'copy'===s.contentPassType?t.scopeType='spread-copy':(t.scopeType='spread-pass',f=!0),d.passes.push(t);c.childDefs.push(t)}u=e.concat(u.slice(p)),p=0}return l}(e,t||{},s);if('fragment'===o&&!s[0])return null;const a='dom'===o&&e||'boundary'===o&&e||'element'===o&&'_'||('content'===o?'':null),d={MIX_DOM_DEF:o,tag:a,childDefs:s},c=!!a;if('fragment'===d.MIX_DOM_DEF);else if(t){const{_key:e,_ref:n,_signals:s,_contexts:r,_disable:i}=t,u=h(t,['_key','_ref','_signals','_contexts','_disable']);if(null!=e&&(d.key=e),n){const e=[];if('Ref'===n.constructor.MIX_DOM_CLASS)e.push(n);else for(const t of n)t&&'Ref'===t.constructor.MIX_DOM_CLASS&&-1===e.indexOf(t)&&e.push(t);d.attachedRefs=e}s&&(d.attachedSignals=Object.assign({},s)),r&&'boundary'===o&&(d.attachedContexts=Object.assign({},r)),c&&(d.props='string'==typeof a?l(u):u)}else c&&(d.props={});switch(d.MIX_DOM_DEF){case'portal':{const e=t||{};d.domPortal=e.container||null;break}case'element':{const e=t||{};d.domElement=e.element||null,d.domCloneMode=null!=e.cloneMode?'boolean'==typeof e.cloneMode?e.cloneMode?'deep':'':e.cloneMode:null,delete d.props.element,delete d.props.cloneMode;break}}return d}function g(e){if(e&&'object'==typeof e){if('string'==typeof e.MIX_DOM_DEF)return e;if(e instanceof Node)return{MIX_DOM_DEF:'content',tag:'',childDefs:[],domContent:e};if('Host'===e.constructor.MIX_DOM_CLASS)return{MIX_DOM_DEF:'host',tag:null,host:e,key:e,childDefs:[]};if(Array.isArray(e)||e instanceof HTMLCollection||e instanceof NodeList){const t=[...e].map((e=>g(e))).filter((e=>e));return t.length?{MIX_DOM_DEF:'fragment',tag:null,isArray:!0,childDefs:t}:null}e=String(e)}return null!=e?{MIX_DOM_DEF:'content',tag:'',domContent:e,childDefs:[]}:null}function y(e,t){const n={MIX_DOM_DEF:e.MIX_DOM_DEF,tag:e.tag,childDefs:[],action:'mounted'};return null!=e.key&&(n.key=e.key),'fragment'===n.MIX_DOM_DEF?(e.isArray&&(n.isArray=!0),e.scopeType&&(n.scopeType=e.scopeType)):'pass'===n.MIX_DOM_DEF?e.getRemote?(n.getRemote=e.getRemote,n.contentPass=e.contentPass||null):n.contentPass=e.contentPass||t||null:e.host&&(n.host=e.host),n}function D(e,t){const n={MIX_DOM_DEF:'pass',tag:null,childDefs:[],contentPassType:t?'copy':'pass'};return null!=e?n.key=e:t||(n.key=p),n}function M(e,t){let n=!1;for(const o of e){if(o.disabled)continue;const e='fragment'===o.MIX_DOM_DEF?M(o.childDefs,t):'pass'!==o.MIX_DOM_DEF||('function'==typeof t?t(o):t&&'maybe');if(e){if(!0===e)return!0;n='maybe'}}return n}const b=D(),v=D({},!0);class _ extends e.SignalMan{constructor(...e){super(...e),this.treeNodes=new Set}onListener(e,t,n){if(super.onListener(e,t,n),this.treeNodes.size){const o=this.signals[e][t],s=o[0];if(n)for(const t of this.getComponents())t.listenTo(e,((...e)=>o[1]?s(t,...e,...o[1]):s(t,...e)),null,o[2],s);else for(const t of this.getComponents())t.unlistenTo(e,s)}}getTreeNode(){return[...this.treeNodes][this.treeNodes.size-1]||null}getTreeNodes(){return[...this.treeNodes]}getElement(e=!1){let t=this.treeNodes.size-1;const n=[...this.treeNodes];for(;t>=0;){const o=n[t];if(o.domNode&&(!e||'dom'===o.type))return o.domNode}return null}getElements(e=!1){let t=[];for(const o of this.treeNodes)o.domNode&&('dom'===o.type?t.push(o.domNode):e||(t=t.concat(n(o,!0).map((e=>e.domNode)))));return t}getComponent(){var e;const t=[...this.treeNodes][this.treeNodes.size-1];return t&&'boundary'===t.type&&(null===(e=t.boundary)||void 0===e?void 0:e.component)||null}getComponents(){var e;const t=[];for(const n of this.treeNodes)'boundary'===n.type&&(null===(e=n.boundary)||void 0===e?void 0:e.component)&&t.push(n.boundary.component);return t}static didAttachOn(t,n){var o;if(!t.treeNodes.has(n))if(t.treeNodes.add(n),'boundary'===n.type){const s=null===(o=n.boundary)||void 0===o?void 0:o.component;for(const e in t.signals)for(const n of t.signals[e]){const[t,o,r]=n;s.listenTo(e,((...e)=>o?t(s,...e,...o):t(s,...e)),null,r,t)}s&&t.signals.didAttach&&e.callListeners(t.signals.didAttach,[s])}else'dom'===n.type&&n.domNode&&t.signals.domDidAttach&&e.callListeners(t.signals.domDidAttach,[n.domNode])}static willDetachFrom(t,n){var o;if(t.treeNodes.has(n))if('boundary'===n.type){const s=null===(o=n.boundary)||void 0===o?void 0:o.component;if(s){t.signals.willDetach&&e.callListeners(t.signals.willDetach,[s]);for(const e in t.signals)for(const n of t.signals[e])s.unlistenTo(e,n[0])}}else'dom'===n.type&&n.domNode&&t.signals.domWillDetach&&e.callListeners(t.signals.domWillDetach,[n.domNode]);t.treeNodes.delete(n)}}_.MIX_DOM_CLASS='Ref';var C=(e,t)=>{var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n};class N{constructor(e,t){this.hydrationRoot=t||null,this.paused=e.disableRendering,this.settings=e,this.externalElements=new Set,this.inBrowser='object'==typeof document}pause(){this.paused=!0}resume(){this.paused&&(this.paused=!1,this.hydrationRoot&&this.rehydrate(null,!0))}rehydrate(e=null,t=!1,o=!1,s=!1,r,i){var a,d,l;const c=this.hydrationRoot;if(!c)return void(this.settings.devLogWarnings&&console.warn('__HostRender.rehydrate: Warning: No hydration root assigned. ',this));let u=null;const f={};if(e&&(u={tag:(null===(a=e.tagName)||void 0===a?void 0:a.toLowerCase())||'',node:e,parent:null,used:!0},e.childNodes[0])){let t,n=[[[...e.childNodes],u]],o=0;for(;t=n[o];){o++;const[e,s]=t;s.children||(s.children=[]);let r=[];for(const t of e){const e={tag:(null===(d=t.tagName)||void 0===d?void 0:d.toLowerCase())||'',node:t,parent:s},n=t instanceof Element?t.getAttribute('_key'):null;null!=n&&(e.key=n,(f[e.tag]||(f[e.tag]=[])).push(e)),s.children.push(e),t.childNodes[0]&&r.push([[...t.childNodes],e])}r[0]&&(n=r.concat(n.slice(o)),o=0)}}const h=new Set(this.externalElements);e&&h.add(e);let p,m=[[c,u]],g=0;const y=[];for(;p=m[g];){g++;let[e,n]=p;if('dom'===e.type){let s=e.domNode;const a=N.getTreeNodeMatch(e,n,f,h,r,i);if(a){let t=null;a instanceof Node?t=a:(n=a,n.used=!0,t=n.node),!t||e.domNode&&!o||(s=t)}s&&h.add(s);const d={treeNode:e};let l=t;if(s!==e.domNode&&(l=!0,e.domNode?s&&(d.swap=s):d.create=!0),!d.create&&s){const[t,n]=N.findInsertionNodes(e);s.parentNode===t&&s.nextSibling===n||(d.move=!0),'content'===e.def.MIX_DOM_DEF?d.content=!0:(l&&(e.domProps=N.readFromDOM(s)),d.update=!0)}(d.create||d.swap||d.move||d.update||d.content)&&y.push(d)}e.children[0]&&(m=e.children.map((e=>[e,n])).concat(m.slice(g)),g=0)}if(this.settings.disableRendering||(this.paused=!1),s&&e){let t,o=e===c.domNode?n(c.children[0],!0).map((e=>e.domNode)).filter((e=>e)):[...e.childNodes],s=0;for(;t=o[s];)s++,h.has(t)?t.childNodes[0]&&(o=[...t.childNodes,...o.slice(s)],s=0):null===(l=t.parentNode)||void 0===l||l.removeChild(t)}if(y[0]&&this.applyToDOM(y),this.pausedPending){const e=this.pausedPending.filter((e=>e.treeNode.domNode&&!h.has(e.treeNode.domNode)));delete this.pausedPending,e[0]&&this.applyToDOM(e)}}applyToDOM(t){const n=this.settings;if(n.devLogRenderInfos&&console.log('__HostRender.applyToDOM: Dev-log: Received rendering infos'+(this.paused?' (while paused)':'')+': ',t),this.paused){const e=t.filter((e=>e.remove));return void(e[0]&&(this.pausedPending=(this.pausedPending||[]).concat(e)))}let o=null,s=null,r=null;for(const i of t){const t=i.treeNode,a=t.def.attachedSignals,d=t.def.attachedRefs;if(i.remove){if('dom'===t.type&&t.domNode){const n=t.domNode,o=n.parentNode;let i=!1;if((null==a?void 0:a.domWillUnmount)&&a.domWillUnmount(n)&&(i=!0),d)for(const o of d)o.signals.domWillUnmount&&e.askListeners(o.signals.domWillUnmount,[n],['no-false','last'])&&(i=!0),_.willDetachFrom(o,t);i?r?r.push(n):r=[n]:!o||s&&-1!==s.indexOf(o)||r&&r.some((e=>e.contains(n)))||o.removeChild(n);const l='element'===t.def.MIX_DOM_DEF;(l||'content'===t.def.MIX_DOM_DEF)&&this.externalElements.delete(n),l||(s||(s=[])).push(n),t.domNode=null,N.updateDOMChainBy(t,null)}continue}let l=!1,c=!1;if(i.refresh&&t.domNode&&t.domProps&&(t.domProps='read'===i.refresh?N.readFromDOM(t.domNode):{},l=!0),i.create)switch(t.type){case'dom':const e=this.createDOMNodeBy(t);e&&(t.domNode=e,c=!0);break;case'portal':t.domNode=t.def.domPortal||null}if(c||i.move)if('host'===t.type){const e=t.def.host||null;e&&e.services.refreshRoot(!1,null,null),t.domNode=t.parent&&e&&e.getRootElement()||null,N.updateDOMChainBy(t,t.domNode)}else t.domNode&&(o||(o=[])).push(i);if(i.swap){const e=!0!==i.swap,o=t.domNode;let s=e?i.swap:('portal'===t.type?t.def.domPortal:t.def.domElement)||null;if(o!==s){if(!e&&'dom'===t.type){const e=t,r=o&&o.parentNode;if(s&&(s=this.getApprovedNode(s,e),s)){let[e,n]=r?[r,o]:N.findInsertionNodes(t);e&&e.insertBefore(s,n)}if(o){if(this.externalElements.delete(o),e.domProps&&o instanceof Element)for(const t in e.domProps){const n=N.LISTENER_PROPS[t];n&&o.removeEventListener(n,e.domProps[t])}r&&r.removeChild(o)}e.domProps&&(e.domProps=s&&'read'===n.renderDOMPropsOnSwap?N.readFromDOM(s):{},l=!0)}for(const e of t.children){const t=e.domNode;t&&(t.parentNode&&t.parentNode.removeChild(t),s&&s.appendChild(t))}t.domNode=s,N.updateDOMChainBy(t,s)}}if(i.content&&'dom'===t.type&&t.domNode){const o=t.def.domContent,s=t.domNode;let r=s;if('content'===t.def.MIX_DOM_DEF){if(t.def.domHTMLMode&&null!=o&&''!==o)r=N.domNodeFrom(o.toString(),t.def.tag||n.renderHTMLDefTag,!0),r&&t.domProps&&(l=!0,t.domProps={});else{const e=null==o?'':(n.renderTextHandler?n.renderTextHandler(o):o).toString();3!==s.nodeType&&this.inBrowser?r=document.createTextNode(e):s.textContent=e}}else if(o instanceof Node){const e=o.parentNode;e&&e.removeChild(o)}else s.textContent='';if(r&&s!==r){const e=s.parentNode;e&&(t.domNode=r,e.insertBefore(r,s),e.removeChild(s)),N.updateDOMChainBy(t,t.domNode)}if((null==a?void 0:a.domDidContent)&&a.domDidContent(t.domNode,null!=o?o:null),d)for(const n of d)n.signals.domDidContent&&e.callListeners(n.signals.domDidContent,[t.domNode,null!=o?o:null])}if((c||l||i.update)&&'dom'===t.type){const[o,s,r]=N.domApplyProps(t,n.devLogWarnings);if(t.domProps=o,r&&i.update&&s&&((null==a?void 0:a.domDidUpdate)&&a.domDidUpdate(s,r),d))for(const t of d)t.signals.domDidUpdate&&e.callListeners(t.signals.domDidUpdate,[s,r])}i.emptyMove&&N.updateDOMChainBy(t,null,!0)}if(o){const t=[];let n=null,s=o.length;for(;s--;){const e=o[s],r=e.treeNode,i=r.domNode;if(i){const o=i.parentNode,s=i.nextSibling,[a,d]=i?N.findInsertionNodes(r):[null,null];a===o&&d===s||(a&&t.push([i,a,d]),(r.def.attachedRefs||r.def.attachedSignals)&&(n||(n=[])).push([!e.move,e.treeNode,o,s]),o&&o.removeChild(i))}N.updateDOMChainBy(r,i)}if(t[0])for(const e of t)e[1].insertBefore(e[0],e[2]);if(n){let t=n.length;for(;t--;){const[o,s,r,i]=n[t],{attachedSignals:a,attachedRefs:d}=s.def,l=s.domNode;if(a&&(o?a.domDidMount&&a.domDidMount(l):a.domDidMove&&a.domDidMove(l,r,i)),d)for(const t of d)o?(_.didAttachOn(t,s),t.signals.domDidMount&&e.callListeners(t.signals.domDidMount,[l])):t.signals.domDidMove&&e.callListeners(t.signals.domDidMove,[l,r,i])}}}}getApprovedNode(e,t){let n=e;const o=null!=t.def.domCloneMode?t.def.domCloneMode:this.settings.duplicateDOMNodeBehaviour;return('always'===o||this.externalElements.has(e))&&(n=this.settings.duplicateDOMNodeHandler?this.settings.duplicateDOMNodeHandler(e,t):o?e.cloneNode('deep'===o||'always'===o):null),n&&this.externalElements.add(n),n}createDOMNodeBy(e){const t=e.def.tag;if('string'!=typeof t)return null;if('_'===t)return e.def.domElement&&this.getApprovedNode(e.def.domElement,e)||null;const n=e.def.domContent;if(n instanceof Node)return this.getApprovedNode(n,e);const o=this.settings;if(e.def.domHTMLMode&&null!=n&&''!==n)return N.domNodeFrom(n.toString(),t||o.renderHTMLDefTag,!0);if(t)return this.inBrowser?'svg'===t||e.parent&&e.parent.domNode&&void 0!==e.parent.domNode.ownerSVGElement?document.createElementNS(o.renderSVGNamespaceURI||'http://www.w3.org/2000/svg',t):document.createElement(t):null;let s=null,r='',i='';if(null!=n){i=(o.renderTextHandler?o.renderTextHandler(n):n).toString();const e=o.renderTextTag;if(e)if('string'==typeof e)r=e;else if('function'==typeof e){const t=e(n);t instanceof Node&&(s=t)}}if(!s){if(!this.inBrowser)return null;s=r?document.createElement(r):document.createTextNode(i)}return r&&i&&(s.textContent=i),s}static findInsertionNodes(e){let t=null,n=e.parent;for(;n;){if(!(N.PASSING_TYPES[n.type]||'root'===n.type&&n.parent)){t=n.domNode;break}n=n.parent}if(!t)return[null,null];let o=null,s=e;for(;s&&(n=s.parent,n);){let e,r=n.children.indexOf(s)+1;for(;e=n.children[r];){if(e.domNode&&'portal'!==e.type){o=e.domNode;break}r++}if(o||n.domNode===t)break;s=n}return[t,o]}static updateDOMChainBy(e,t,n=!1){let o=e,s=n?e:e.parent,r=t;for(;s&&(N.PASSING_TYPES[s.type]||s===o);){if(s.children[0]!==o&&s!==o){let e=!1,t=s.children.indexOf(o)-1;for(;t>=0;){if(s.children[t].domNode){e=!0;break}t--}if(e)break}if(!r){let e,t=s.children.indexOf(o)+1;for(;e=s.children[t];){if(e.domNode&&'portal'!==e.type){r=e.domNode;break}t++}if(r&&s.domNode===r)break}s.domNode=r,o=s,s=s.parent}}static readFromDOM(e){const t={};if(!(e instanceof Element))return t;for(const n of e.getAttributeNames())t['class'===n?'className':n]=e.getAttribute(n);const n=e.style.cssText;n&&(t.style=c(n));const o=e.dataset;if(o&&Object.keys(o).length){t.data={};for(const e in o)t.data[e]=o[e]}return t}static domNodeFrom(e,t='div',n=!1){const o=t instanceof Element?t:'object'==typeof document?document.createElement(t):null;return o?(o.innerHTML=e,n||o.children[1]?o:o.children[0]):null}static domApplyProps(e,t=!1){const n=e.domNode instanceof Element?e.domNode:null,o={},s=e.domProps||{},r=e.def.props||{},a=i(s,r);if(!a)return[r,n];const d={};for(const l in a){const c=N.SPECIAL_PROPS[l];if(c){if('render'===c)t&&console.warn('__HostRender.domApplyProps: Warning: Is using an ignored dom prop: ',l,' for treeNode: ',e);else if('className'===l){const e=f(s.className,r.className);if(e){if(d.classNames=e,n)for(const t in e)n.classList[e[t]?'add':'remove'](t);r.className?o.className=r.className:delete o.className}}else{const e=r[l],t=i(s[l]||{},e||{});if(t){if(d[l]=t,n)if('data'===l){const e=n.dataset;if(e)for(const n in t)void 0!==t[n]?e[n]=t[n]:delete e[n]}else{const e=n.style;if(e)for(const n in t)e[n]=null!=t[n]?t[n]:null}e?o[l]=e:delete o[l]}}continue}const u=a[l],h=void 0!==u,p=N.LISTENER_PROPS[l];if(p){if(d.listeners||(d.listeners={}),d.listeners[l]=u,n){const e=s[l];e&&n.removeEventListener(p,e),h&&n.addEventListener(p,u)}}else d.attributes||(d.attributes={}),d.attributes[l]=u,n&&(h?n.setAttribute(l,u):n.removeAttribute(l));h?o[l]=u:delete o[l]}for(const e in d)return[o,n,d];return[o,n]}static decapitalizeString(e,t=''){return e.replace(/([A-Z])/g,t+'$1').toLowerCase()}static readAsString(e){const t=e.def;if(!t)return'';let n=t.tag,o='';if('string'!=typeof n){for(const t of e.children)o+=N.readAsString(t);return o}let s=null;if(n)'_'===n&&(s=t.domElement||null);else{const e=t.domContent;e&&(e instanceof Node?s=e:o+=e.toString())}if(!n&&!s)return o;let r=e.domProps;if(s){if(s instanceof Element&&(n=s.tagName.toLowerCase()||''),!n)return s.textContent||'';const e=N.readFromDOM(t.domElement),{className:o,style:i,data:a}=e,d=C(e,['className','style','data']);if(o&&(r.className=r.className?r.className+' '+o:o),i){r.style=r.style||{};for(const e in i)r.style[e]=i[e]}if(a){r.data=r.data||{};for(const e in a)r.data[e]=a[e]}for(const e in d)r[e]=d[e]}const{className:i,style:a,data:d}=r,l=C(r,['className','style','data']);if(o+='<'+n,i&&(o+=' class="'+i+'"'),a){let e='';for(const t in a)e+=t+': '+a[t]+';';e&&(o+=' style="'+e+'"')}if(d)for(const e in d)o+=' data-'+N.decapitalizeString(e,'-')+'="'+d[e].toString()+'"';for(const e in l)N.LISTENER_PROPS[e]||N.SPECIAL_PROPS[e]||(o+=' '+e+'="'+l[e].toString()+'"');if(N.SIMPLE_TAGS[n])o+='/>';else{o+='>';for(const t of e.children)o+=N.readAsString(t);o+='</'+n+'>'}return o}static getTreeNodeMatch(e,t,n,o,s,r){const i=e.def.tag,a=e.def.key;if(r){const n=r(t,e,i,a);if(n){if((n instanceof Element?n.tagName.toLowerCase():'')===i&&(n instanceof Node?!(null==o?void 0:o.has(n)):!(null==o?void 0:o.has(n.node))&&N.isVirtualItemOk(e,n,t,s)))return n}}const d=null!=a;if(t)for(const n of t.used?t.children||[]:[t])if(!n.used&&n.tag===i&&(d?n.key===a:null==n.key)&&!(null==o?void 0:o.has(n.node))&&(!s||s(n,e,i,a)))return n;if(n&&d){const r=n[i];if(r)for(const n of r)if(!n.used&&n.key===a&&!(null==o?void 0:o.has(n.node))&&N.isVirtualItemOk(e,n,t,s))return n}return null}static isVirtualItemOk(e,t,n,o){if(t.tag!==e.def.tag)return!1;const s=e.def;if(n){let r=t;for(;r;){if(r===n)return!o||o(t,e,s.tag,s.key);r=r.parent}}else if(!o||o(t,e,s.tag,s.key))return!0;return!1}}function P(e,...t){let n=e;for(const e of t)e&&(n?(n[0]=n[0].concat(e[0]),n[1]=n[1].concat(e[1])):n=e);return n}function O(e){const t=new Map;for(const n of e){let e=n.bId,o=n.parentBoundary;for(;o;)e=(o.bId||'')+'>'+e,o=o.parentBoundary;const s=t.get(e);if(s){let e=0;if(n.parentBoundary){const t=n.parentBoundary.innerBoundaries,o=t.indexOf(n);for(const n of s){if(o<t.indexOf(n))break;e++}}s.splice(e,0,n)}else t.set(e,[n])}const n=[];for(const e of t.keys()){let t=0,o=!1;for(const s of n){if(s.startsWith(e+'>'))break;if(e.startsWith(s+'>'))o=!0;else if(o)break;t++}n.splice(t,0,e)}let o=0;for(const s of n)for(const n of t.get(s))e[o]=n,o++}function S(e,t=!0){let n=[],o=[];t&&e.size>1&&O(e);for(const t of e){if(!t._forceUpdate&&!t.component._lastState&&t.component.props===t._outerDef.props)continue;const e=t.host.services.updateBoundary(t);e&&(n=n.concat(e[0]),o=o.concat(e[1]))}return[n,o]}function I(e,t){var n;if(t)return(null===(n=t.constructor.closure)||void 0===n?void 0:n.withContents)?new Set(t.constructor.closure.withContents):null;if(!e.withContents&&!e.chainedClosures)return null;const o=e.withContents?new Set(e.withContents):new Set;if(e.chainedClosures)for(const t of e.chainedClosures){const e=I(t);if(e)for(const t of e)o.add(t)}return o.size?o:null}N.SIMPLE_TAGS=['img'],N.SPECIAL_PROPS={innerHTML:'render',outerHTML:'render',textContent:'render',innerText:'render',outerText:'render',style:'other',data:'other',className:'other'},N.PASSING_TYPES={boundary:!0,pass:!0,host:!0,fragment:!0},N.LISTENER_PROPS=['Abort','Activate','AnimationCancel','AnimationEnd','AnimationIteration','AnimationStart','AuxClick','Blur','CanPlay','CanPlayThrough','Change','Click','Close','ContextMenu','CueChange','DblClick','Drag','DragEnd','DragEnter','DragLeave','DragOver','DragStart','Drop','DurationChange','Emptied','Ended','Error','Focus','FocusIn','FocusOut','GotPointerCapture','Input','Invalid','KeyDown','KeyPress','KeyUp','Load','LoadedData','LoadedMetaData','LoadStart','LostPointerCapture','MouseDown','MouseEnter','MouseLeave','MouseMove','MouseOut','MouseOver','MouseUp','Pause','Play','Playing','PointerCancel','PointerDown','PointerEnter','PointerLeave','PointerMove','PointerOut','PointerOver','PointerUp','Progress','RateChange','Reset','Resize','Scroll','SecurityPolicyViolation','Seeked','Seeking','Select','Stalled','Submit','Suspend','TimeUpdate','Toggle','TouchCancel','TouchEnd','TouchMove','TouchStart','TransitionCancel','TransitionEnd','TransitionRun','TransitionStart','VolumeChange','Waiting','Wheel'].reduce(((e,t)=>(e['on'+t]=t.toLowerCase(),e)),{});const x={fragment:1,portal:2,pass:3,host:4};function w(e,t,n,o,s){t.children[0]&&(t.children=[]);const r=e.length;if(!r)return[];const i=[];let a=0,d=null,l=t;if(n){if(!t.parent)return[];if(l=t.parent,d=t,a=l.children.indexOf(t),-1===a)return[]}for(let t=0;t<r;t++){const n=e[t];if(n.disabled){a--,i.push(null);continue}let r=null;n.treeNode?r=n.treeNode:'fragment'!==n.MIX_DOM_DEF&&(n.action='mounted'),d&&(r?l.children.splice(a,1):r=d,d=null);const c=n.MIX_DOM_DEF,u='content'===c||'element'===c?'dom':'fragment'===c?'':c;if(r){if(r.parent){const e=r.parent.children.indexOf(r);0===e&&r.parent!==l&&!0===N.PASSING_TYPES[r.parent.type]&&s&&-1===s.indexOf(r.parent)&&s.push(r.parent),-1!==e&&r.parent.children.splice(e,1)}r.parent=l,r.sourceBoundary=o||null,r.type=u}else r={type:u,parent:l,children:[],sourceBoundary:o||null,domNode:null},'dom'===r.type&&(r.domProps={});'fragment'!==n.MIX_DOM_DEF&&(r.def=n,n.treeNode=r),l.children.splice(a+t,0,r),i.push(r)}return i}function T(e,t,n,o,s,r){var i,d,l,c,u,f;let h=t.childDefs.length;if(!h)return[];const p=r||!t.isArray;if(!r&&t.isArray!=(e&&e.isArray))return t.childDefs.map((e=>y(e,s&&s.closure||null)));const m=e&&e.childDefs||null,g=[];for(let r=0;r<h;r++){const h=t.childDefs[r],D=null!=h.key,M=h.MIX_DOM_DEF,b=h.getRemote||x[M]||h.tag;let v=!1,_=null;if(m)for(const e of m)if((D?e.key===h.key:null==e.key)&&b===(e.getRemote||x[e.MIX_DOM_DEF]||e.tag)&&o.has(e)&&('boundary'!==M||!(null===(l=null===(d=null===(i=e.treeNode)||void 0===i?void 0:i.boundary)||void 0===d?void 0:d.component)||void 0===l?void 0:l.constantProps)||a(h.props,e.props,e.treeNode.boundary.component.constantProps))){_=e,o.delete(e);break}if(!_&&D&&p){const e=n&&n.get(b);if(e)for(const t of e)if(t.key===h.key&&o.has(t)&&('boundary'!==M||!(null===(f=null===(u=null===(c=t.treeNode)||void 0===c?void 0:c.boundary)||void 0===u?void 0:u.component)||void 0===f?void 0:f.constantProps)||a(h.props,t.props,t.treeNode.boundary.component.constantProps))){_=t,o.delete(t),v=!0;break}}_?_.action=v||!e||e.childDefs[r]!==_?'moved':'updated':_=y(h,s&&s.closure||null),g.push(_)}return g}function R(e,t=!1,n=new Set,o){const s=new Map;let r,i=t?e.childDefs.slice():[e],a=0;for(;r=i[a];){a++,n.add(r);const e=r.getRemote||x[r.MIX_DOM_DEF]||r.tag,t=s.get(e);if(t?t.push(r):s.set(e,[r]),r.scopeType)if('spread-pass'===r.scopeType)o&&o.push(r);else{const e=[];r.scopeMap=R(r,!0,n,e)[0],e[0]&&(i=e[0].childDefs.concat(i.slice(a)),a=0)}else r.childDefs[0]&&(i=r.childDefs.concat(i.slice(a)),a=0)}return[s,n]}class E{constructor(e,t,n){this.host=e,this.treeNode=n,this._outerDef=t,this._innerDef=null,this.isMounted=!1,this.sourceBoundary=null,this.parentBoundary=null,this.innerBoundaries=[]}}class A extends E{constructor(e,t,n,o){super(o.host,e,n),this.sourceBoundary=o,this.targetDef=t,this._innerDef=y(t,o.closure)}updateEnvelope(e,t){this.targetDef=e,t&&(this._innerDef.childDefs=t.childDefs)}}class B{constructor(e,t){this.thruBoundary=e||null,this.sourceBoundary=t||null,this.envelope=null,this.truePassDef=null,this.groundedDefs=new Map,this.pendingDefs=new Set}hasContent(){var e;const t=null===(e=this.envelope)||void 0===e?void 0:e.applied;return!(!t||t.disabled||'fragment'===t.MIX_DOM_DEF&&(!t.childDefs.length||t.childDefs[0].disabled&&1===t.childDefs.length))}readContent(e=!1){if(!this.envelope)return null;const t=this.envelope.applied,n=t.childDefs;if('fragment'===t.MIX_DOM_DEF&&(!n.length||n[0].disabled&&1===n.length))return null;const o=this.envelope.target.childDefs;return e?o.slice():o}}class L extends e.ContextAPI{getContext(e,t=!0){return void 0!==this.contexts[e]?this.contexts[e]:t?this.host.contextAPI.contexts[e]:void 0}getContexts(e,t=!0,n=!1){return t?Object.assign(Object.assign({},this.host.contextAPI.getContexts(e,n)),super.getContexts(e,n)):super.getContexts(e,n)}afterRefresh(e,t,n){return this.host.afterRefresh(e,t,n)}}function k(n){var r;return(r=class extends(e.SignalManMixin(n)){constructor(e,t,...n){super(...n),this.props=e,t&&(this.boundary=t,t.component=this)}initContextAPI(){if(this.contextAPI)return;this.contextAPI=new L,this.contextAPI.host=this.boundary.host,this.boundary.host.contextComponents.add(this);const e=this.boundary._outerDef.attachedContexts;if(e)for(const t in e)this.contextAPI.setContext(t,e[t],!1)}isMounted(){return!0===this.boundary.isMounted}getLastState(e=!0){return this._lastState||e&&this.state||null}getHost(){return this.boundary.host}queryElement(e,t=!1,n=!1){return o(this.boundary.treeNode,e,t,n)}queryElements(e,t=0,n=!1,o=!1){return s(this.boundary.treeNode,e,t,n,o)}findElements(e=0,n=!1,o=!1,s){return t(this.boundary.treeNode,{dom:!0},e,n,o,s).map((e=>e.domNode))}findComponents(e=0,n=!1,o=!1,s){return t(this.boundary.treeNode,{boundary:!0},e,n,o,s).map((e=>e.boundary&&e.boundary.component))}findTreeNodes(n,o=0,s=!1,r=!1,i){return t(this.boundary.treeNode,n&&e.buildRecordable(n),o,s,r,i)}setTimer(e,t,n){return null==e&&(e={}),this.timers?this.timers.has(e)&&this.clearTimers(e):this.timers=new Map,this.timers.set(e,setTimeout((()=>{this.clearTimers(e),t.call(this)}),n)),e}hasTimer(e){return!!this.timers&&this.timers.has(e)}clearTimers(...e){if(this.timers)if(e.length)for(const t of e){const e=this.timers.get(t);null!=e&&(clearTimeout(e),this.timers.delete(t))}else this.timers.forEach((e=>clearTimeout(e))),this.timers.clear()}setUpdateModes(e,t=!0){t&&this.updateModes||(this.updateModes={});for(const t in e)this.updateModes[t]=e[t]}setConstantProps(e,t=!0,n=null){var o,s;t&&this.constantProps||(this.constantProps={});let r=!1;if(e)if(Array.isArray(e))for(const t of e)this.constantProps[t]=null===(o=(r=!0)&&n)||void 0===o||o;else for(const t in e)this.constantProps[t]=null!==(s=(r=!0)&&n)&&void 0!==s?s:e[t];r||t||delete this.constantProps}setState(e,t,n,o){this.boundary.updateBy({state:Object.assign(Object.assign({},this.state),e)},t,n,o)}setInState(e,t,n,o,s){this.boundary.updateBy({state:Object.assign(Object.assign({},this.state),{[e]:t})},n,o,s)}triggerUpdate(e,t,n){this.boundary.host.services.absorbUpdates(this.boundary,{force:e||!1},!0,t,n)}addWired(e){this.wired?this.wired.add(e):this.wired=new Set([e])}removeWired(e){var t;null===(t=this.wired)||void 0===t||t.delete(e)}afterRefresh(e=!1,t,n){return this.boundary.host.afterRefresh(e,t,n)}render(e,t){return null}}).MIX_DOM_CLASS='Component',r}const F=k;class X extends(k(Object)){constructor(e,t,...n){super(e,t,...n)}}function j(e,t=e.name){return{[t]:e.length>1?(t,n,o)=>e(n,o):(t,n)=>e(n)}[t]}const U=(e,t=e.name)=>({[t]:(t,n,o)=>e(n,o)}[t]);class W extends E{constructor(e,t,n,o){super(e,t,n),this.bId=e.services.createBoundaryId(),this.sourceBoundary=o||null,this.closure=new B(this,o)}reattach(){this.component=null;const t=this._outerDef.props||{};let n=this._outerDef.tag;if('function'==typeof n){const o=n.api,s=n.MIX_DOM_CLASS?null:this._outerDef.tag,r=s&&s.length>=3||!1,i=this.component=new(s?o?{[s.name]:class extends X{}}[s.name]:X:n)(t,this);if(this.component=i,r&&i.initContextAPI(),s&&(i.render=r?e=>s.call(i,e,i,i.contextAPI):e=>s.call(i,e,i)),i.boundary||(i.boundary=this),o){i.constructor.api=o,o.components.add(i);for(const e in o.signals)for(const t of o.signals[e]){const[n,o,s]=t;i.listenTo(e,((...e)=>o?n(i,...e,...o):n(i,...e)),null,s,n)}}'Remote'===n.MIX_DOM_CLASS&&(this.closure.remote=i,n.addSource(i)),i.signals.preMount&&e.callListeners(i.signals.preMount)}else this.component=new X(t,this)}update(e,t,n){this.host.services.absorbUpdates(this,{force:this.isMounted?e||!1:'all'},!0,t,n)}updateBy(e,t,n,o){this.host.services.absorbUpdates(this,Object.assign(Object.assign({},e),{force:this.isMounted?t||!1:'all'}),!0,n,o)}render(e=0){const t=!1===this.isMounted&&!this._renderState;e||(this._renderState='active');const n=this.component,o=n.render(n.props||{},n.state),s='function'==typeof o;if(s&&(n.render=o),t&&n.contextAPI&&n.contextAPI.callDataBy(),s)return this.render(e);if('re-updated'===this._renderState){const t=this.host.settings;if(t.maxReRenders<0||e<t.maxReRenders)return e++,this._renderState='active',this.render(e);t.devLogWarnings&&console.warn('__SourceBoundary.render: Warning: The component tried to render for over '+(e+1).toString()+' times.',this._outerDef.tag.MIX_DOM_CLASS?n.constructor:this._outerDef.tag,n)}return delete this._renderState,o}}function H(e,t=!1){const[n,o,s]=function(e){const t=e._innerDef,n=e.sourceBoundary,o=[],s=[],r=[];let i,a=[[e.targetDef,t,e.treeNode,!1]],d=0;for(;i=a[d];){d++;const[e,t,l,c]=i;if(t.childDefs[0]){const r=l&&'boundary'!==e.MIX_DOM_DEF&&('element'!==e.MIX_DOM_DEF||e.domElement)?w(t.childDefs,l,c,n,s):[];let i=0;const u=[];for(const n of t.childDefs){const t=r[i]||null;!t&&n.treeNode&&(o.push(n.treeNode),n.treeNode.sourceBoundary=null),u.push([e.childDefs[i],n,t,'fragment'===n.MIX_DOM_DEF]),i++}a=u.concat(a.slice(d)),d=0}l&&!t.disabled&&r.push([e,t,l])}return[r,o,s]}(e);let[r,i]=G(e,n,t);if(o[0]){const e=new Set;for(const t of o)t.sourceBoundary||(t.def&&e.add(t.def),t.parent=null);if(e.size){const t=V(e);r=t[0].concat(r),i=t[1].concat(i)}}return s[0]&&(r=s.map((e=>({treeNode:e,emptyMove:!0}))).concat(r)),e.isMounted=!0,[r,i]}function z(e,t=!1){let n,o,s=null,r=e._innerDef;e.bId?(s=g(e.render()),s&&!r&&(r=y(s,e.closure))):s=e.targetDef;const[i,a]=r?R(r):[new Map,new Set],d=[];if(s){const l=[],c=function(e,t,n,o,s,r,i){const a=e.host.settings,d=a.noRenderValuesMode,l=a.wideKeysInArrays,c=[],u=e.bId?e:e.sourceBoundary;let f,h=[[{childDefs:[t]},{childDefs:[n]},e.treeNode,!1,null]],p=0;for(;f=h[p];){p++;const[e,t,n,a]=f,m='spread-pass'===t.scopeType?void 0:t.scopeMap||f[5];if(e.childDefs[0]){const c=T(t,e,m||o,s,u,l);t.childDefs=c;for(let n,o=0;n=e.childDefs[o];o++)if('content'===n.MIX_DOM_DEF){const e=t.childDefs[o];d&&(!0===d?!n.domContent:-1!==d.indexOf(n.domContent))?e.disabled=!0:delete e.disabled}const g='boundary'===e.MIX_DOM_DEF,y=f[4]||g&&t;g&&delete t.hasPassWithin;const D=!n||g||'element'===e.MIX_DOM_DEF&&!e.domElement?[]:w(c,n,a,u,i),M=[];for(let t,n=0;t=e.childDefs[n];n++){const e=D[n]||null,o=c[n];!e&&o.treeNode&&(o.treeNode.sourceBoundary=null,r&&r.push(o)),y&&'pass'===t.MIX_DOM_DEF&&(y.hasPassWithin=!0);const s=[t,o,e,'fragment'===t.MIX_DOM_DEF,y||'boundary'===t.MIX_DOM_DEF&&o||null];M.push(s),m&&(s[5]=m)}h=M.concat(h.slice(p)),p=0}else t.childDefs=[];n&&e.MIX_DOM_DEF&&t.MIX_DOM_DEF&&c.push([e,t,n])}return c}(e,s,r,i,a,l,d);if(e._innerDef=c[0][1],[n,o]=G(e,c,t),l[0])for(const e of l){const t=e.treeNode;t&&null===t.sourceBoundary&&a.add(e)}}else n=[],o=[],!r&&e.isMounted||d.push(e.treeNode),e.innerBoundaries=[],e.treeNode.children=[],e._innerDef=null;if(a.size){const e=V(a);n=e[0].concat(n),o=e[1].concat(o)}return d[0]&&(n=d.map((e=>({treeNode:e,emptyMove:!0}))).concat(n)),e.isMounted||(e.isMounted=!0),[n,o]}function G(e,t,o=!1){var s,r;const a=e.bId?e:e.sourceBoundary,l=[],c=e.host.settings.preCompareDOMProps;e.innerBoundaries=[];let u=[[],[]];for(const f of t){const[t,h,p]=f,m='mounted'===h.action;if(!m&&'moved'===h.action)switch(h.MIX_DOM_DEF){case'fragment':for(const e of n(p,!0,!0))-1===l.indexOf(e)&&(l.push(e),u[0].push({treeNode:e,move:!0}));break;case'host':h.host&&h.host.groundedTree.parent===p&&u[0].push({treeNode:p,move:!0})}if('fragment'===h.MIX_DOM_DEF)continue;if('pass'===p.type){if('pass'!==h.MIX_DOM_DEF)continue;let t=h.contentPass,n=b.key;if(h.getRemote){const e=h.getRemote();n=null===(s=e.Content)||void 0===s?void 0:s.key;const o=e.closure||null;t!==o&&(t&&P(u,Y(t,h)),h.contentPass=o,t=o)}t&&P(u,K(t,h,e,p,h.key!==n?h.key:null)),p.boundary&&e.innerBoundaries.push(p.boundary);continue}const g=h.props;let y=!1;t.props&&h.props!==t.props&&(p.boundary&&(p.boundary._outerDef.props=t.props),h.props=t.props||{});let D=!1;switch(h.MIX_DOM_DEF){case'content':D=!0;const n=t.domHTMLMode;y=h.domContent!==t.domContent||n!==t.domHTMLMode,y&&(h.domContent=t.domContent,void 0!==n?h.domHTMLMode=n:delete h.domHTMLMode);break;case'element':D=!0,h.domElement!==t.domElement&&(m||u[0].push({treeNode:p,swap:!0}),h.domElement=t.domElement||null),h.domCloneMode=null!=t.domCloneMode?t.domCloneMode:null;break;case'dom':D=!0;break;case'portal':h.domPortal!==t.domPortal&&(u[0].push({treeNode:p,[m?'create':'swap']:!0}),h.domPortal=t.domPortal||null);break;case'boundary':if(m){t.attachedContexts&&(h.attachedContexts=t.attachedContexts);const n=new W(e.host,h,p,a);n.parentBoundary=e,p.boundary=n}break;case'host':if(h.host){const e=h.host;let t=e;if('mounted'===h.action){if(e.groundedTree.parent){const n=t.settings.duplicatableHost;if('function'==typeof n){const e=n(h.host,p);if(!e)break;if('object'==typeof e){if(e.groundedTree.parent)break;t=e}}else if(!n)break;const o=e.shadowAPI;t===e?t=new e.constructor(e.services.getRootDef(!0),null,e.settings,null,o):t.shadowAPI!==e.shadowAPI&&(t.shadowAPI.hosts.delete(t),t.shadowAPI=e.shadowAPI);for(const e in o.contexts){const n=o.contexts[e];n&&t.contextAPI.setContext(e,n,!1)}h.host=t}e.shadowAPI.hosts.add(t)}t.groundedTree.parent=p,p.children=[t.groundedTree],u[0].push({treeNode:p,move:!0});break}}if(D){if(m)u[0].push({treeNode:p,create:!0});else{const e='moved'===h.action&&-1===l.indexOf(p),n=!!h.tag&&(!c||'if-needed'===c&&(y||e)||!d(g||{},t.props||{}));if(n||y||e){const t={treeNode:p};n&&(t.update=!0),y&&(t.content=!0),e&&(t.move=!0,l.push(p)),u[0].push(t)}}h.attachedSignals!==t.attachedSignals&&(t.attachedSignals?h.attachedSignals=t.attachedSignals:delete h.attachedSignals)}if(p.boundary){const n=p.boundary;if(e.innerBoundaries.push(n),m){if(h.tag&&h.tag._WithContent){const e=h.tag._WithContent,t=e.getRemote?e.getRemote().closure:a.closure;(t.withContents||(t.withContents=new Set)).add(n)}n.reattach()}const s=n.component;if(h.attachedSignals!==t.attachedSignals){const e=i(h.attachedSignals||{},t.attachedSignals||{});if(e)for(const t in e)e[t]?s.listenTo(t,e[t]):s.unlistenTo(t,h.attachedSignals[t]);h.attachedSignals=t.attachedSignals}if(h.attachedContexts!==t.attachedContexts){if(s.contextAPI){const e=i(h.attachedSignals||{},t.attachedSignals||{});if(e){for(const t in e)e[t]?s.contextAPI.setContext(t,e[t]):s.contextAPI.setContext(t,null);s.contextAPI.callDataBy(m||Object.keys(e))}}h.attachedContexts=t.attachedContexts}let d=null;const c=n.closure.envelope;t.childDefs[0]&&(d=c?{applied:Object.assign(Object.assign({},c.applied),{childDefs:h.childDefs,action:h.action}),target:Object.assign(Object.assign({},c.target),{childDefs:t.childDefs})}:{applied:{tag:null,MIX_DOM_DEF:'fragment',childDefs:h.childDefs,action:'mounted'},target:{tag:null,MIX_DOM_DEF:'fragment',childDefs:t.childDefs}}),'Remote'===s.constructor.MIX_DOM_CLASS&&(u=P(u,s.reattachSource()));const f=c||d?n.closure:null;let g=null;if(f){g=$(f,d);const e=a.closure;h.hasPassWithin?(e.chainedClosures||(e.chainedClosures=new Set)).add(f):null===(r=e.chainedClosures)||void 0===r||r.delete(f)}u=P(u,e.host.services.updateBoundary(n,o,l,g)),f&&(u=P(u,J(f,o)))}if(h.attachedRefs||t.attachedRefs){const e=h.attachedRefs,n=t.attachedRefs;if(e)for(const t of e)n&&n.includes(t)||_.willDetachFrom(t,p);if(n)for(const t of n)e&&e.includes(t)||_.didAttachOn(t,p);h.attachedRefs=n}}return u}function V(e,t=!0,n=!0){var o;let s=[[],[]];for(const r of e){const e=r.treeNode;if(e){switch(r.MIX_DOM_DEF){case'dom':case'element':case'content':n&&s[0].push({treeNode:e,remove:!0});break;case'boundary':e.boundary&&(s=P(s,q(e.boundary,!1,n)));break;case'pass':r.contentPass&&(s=P(s,Y(r.contentPass,r)));case'host':{const t=r.host;if(t&&t.groundedTree.parent===e){t.groundedTree.parent=null,e.children=[],s[0].push({treeNode:e,move:!0}),t.shadowAPI.hosts.delete(t);const n=t.contextAPI;for(const e in n.contexts)null===(o=n.contexts[e])||void 0===o||o.contextAPIs.delete(n)}}default:if(r.attachedRefs&&r.MIX_DOM_DEF)for(const t of r.attachedRefs)_.willDetachFrom(t,e)}t&&(e.parent=null,e.sourceBoundary=null,delete r.treeNode)}}return s}function q(t,o=!0,s=!0){var r,i,a,d;let l=[[],[]];if(null===t.isMounted)return l;const c=t.bId?t:null;if(c){const t=c.component,n=t.constructor;t.signals.willUnmount&&e.callListeners(t.signals.willUnmount);const o=c._outerDef;if(o.attachedRefs)for(const e of o.attachedRefs)_.willDetachFrom(e,c.treeNode);null===(i=null===(r=c.sourceBoundary)||void 0===r?void 0:r.closure.chainedClosures)||void 0===i||i.delete(c.closure);const s=t.contextAPI;if(s){for(const e in s.contexts)null===(a=s.contexts[e])||void 0===a||a.contextAPIs.delete(s);s.contexts={},c.host.contextComponents.delete(t)}if(n.api&&(n.api.components.delete(t),n.api.signals&&(n.api.signals={})),'Remote'===n.MIX_DOM_CLASS&&(l=P(l,n.removeSource(t))),o.tag._WithContent){const e=o.tag._WithContent,t=e.getRemote?e.getRemote().closure:null===(d=c.sourceBoundary)||void 0===d?void 0:d.closure;(null==t?void 0:t.withContents)&&(t.withContents.delete(c),t.withContents.size||delete t.withContents)}t.signals&&(t.signals={}),t.timers&&t.clearTimers()}return s&&(l[0]=l[0].concat(n(t.treeNode,!0).map((e=>({treeNode:e,remove:!0}))))),t._innerDef&&(l=P(l,V(function(e){const t=[];let n,o=[e],s=0;for(;n=o[s++];)t.push(n),n.childDefs[0]&&(o=n.childDefs.concat(o.slice(s)),s=0);return t}(t._innerDef),o,!1))),c&&c.host.services.cancelUpdates(c),t.isMounted=null,l}function K(e,t,o,s,r){return e.groundedDefs.get(t)?'moved'===t.action&&s.boundary?[n(s.boundary.treeNode,!0,!0).map((e=>({treeNode:e,move:!0}))),[]]:[[],[]]:(e.groundedDefs.set(t,[o,s,r]),Q(e,[t]))}function Y(e,t){const n=e.groundedDefs.get(t);if(!n)return[[],[]];e.truePassDef===t&&(e.truePassDef=null),e.groundedDefs.delete(t),e.pendingDefs.delete(t);const o=n[1].boundary;return o?q(o):[[],[]]}function Z(e,t){const n=$(e,t),o=n&&S(n),s=J(e);return o?[o[0].concat(s[0]),o[1].concat(s[1])]:s}function $(e,t,n){if(e.remote&&e.remote.canRefresh())return e.envelope=t,e.remote.preRefresh(t);if(!e.envelope&&!t)return null;const o=I(e,n);if(o)for(const e of o)e._forceUpdate=e._forceUpdate||!0;return e.envelope=t,e.pendingDefs=new Set(e.groundedDefs.keys()),o}function J(e,t=!1){if(e.remote&&e.remote.canRefresh())return e.remote.applyRefresh(t);let n=[],o=[];return e.pendingDefs.size&&([n,o]=Q(e,e.pendingDefs,t)),[n,o]}function Q(e,t,n=!1){t||(t=e.groundedDefs.keys());let o=[],s=[];for(const r of t){e.pendingDefs.delete(r);const t=e.groundedDefs.get(r);if(void 0===t)continue;let[i,a,d]=t,l=a.boundary;if(e.envelope&&e.sourceBoundary){let t=!0;const c=e.envelope;l?(t=e.truePassDef===r,l.updateEnvelope(c.target,t?c.applied:null)):(l=new A(r,c.target,a,e.sourceBoundary),t=null==d&&(!e.truePassDef||e.truePassDef===r),t&&(l._innerDef.childDefs=c.applied.childDefs,e.truePassDef=r),l.parentBoundary=i,a.boundary=l);const[u,f]=t?H(l,n):z(l,n);o=o.concat(u),s=s.concat(f)}else if(l){const e=q(l,!1);o=o.concat(e[0]),s=s.concat(e[1]),a.boundary=null}}return[o,s]}class ee{constructor(e){this.host=e,this.renderer=new N(e.settings,e.groundedTree),this.bIdCount=0,this.updateTimer=null,this.renderTimer=null,this.updatesPending=new Set,this.rInfosPending=[],this.rCallsPending=[]}createBoundaryId(){return'h-'+this.host.constructor.idCount.toString()+':b-'+(this.bIdCount++).toString()}clearTimers(e=!1){e||this.runUpdates(null),null!=this.updateTimer&&(clearTimeout(this.updateTimer),this.updateTimer=null),null!=this.renderTimer&&(clearTimeout(this.renderTimer),this.renderTimer=null)}createRoot(e){return this.rootDef=g(e),(e,t)=>()=>this._rootDisabled?null:this.rootDef}updateRoot(e,t,n){this.rootDef=g(e),this.host.rootBoundary.update(!0,t,n)}refreshRoot(e=!1,t,o){const s=!this._rootDisabled,r=this.host,i=!(r.settings.onlyRunInContainer&&!r.groundedTree.domNode&&!r.groundedTree.parent);if(i?delete this._rootDisabled:this._rootDisabled=!0,!e&&i&&s){if(i&&s){const e=r.rootBoundary?n(r.rootBoundary.treeNode,!0).map((e=>({treeNode:e,move:!0}))):[];this.absorbChanges(e,null,o)}}else r.rootBoundary.update(!0,t,o)}clearRoot(e=!1){this.clearTimers(e),this.rootDef=null}getRootDef(e){return this.rootDef&&(e?Object.assign({},this.rootDef):this.rootDef)}hasPending(e=!0,t=!0){return e&&null!==this.updateTimer||t&&null!==this.renderTimer}cancelUpdates(e){this.updatesPending.delete(e)}absorbUpdates(e,t,n=!0,o,s){if(null!==e.isMounted){if(t.force&&(e._forceUpdate='all'===e._forceUpdate?'all':t.force),t.props&&(e._outerDef.props=t.props),t.state){const n=e.component;n._lastState||(n._lastState=Object.assign({},n.state)),n.state=t.state}e._renderState?e._renderState='re-updated':(this.updatesPending.add(e),n&&this.triggerUpdates(o,s))}}triggerUpdates(e,t){void 0!==t&&(null===t||void 0===this._renderTimeout||null!==this._renderTimeout&&t<this._renderTimeout)&&(this._renderTimeout=t),this._isUpdating||this.triggerRefreshFor('update',e)}runUpdates(e){for(this.updateTimer=null,this._isUpdating=!0,e=void 0!==e?e:void 0!==this._renderTimeout?this._renderTimeout:this.host.settings.renderTimeout,delete this._renderTimeout;this.updatesPending.size;){let e=[...this.updatesPending];this.updatesPending.clear(),e[1]&&O(e);let t=[],n=[];for(const o of e){const e=this.updateBoundary(o);e&&(t=t.concat(e[0]),n=n.concat(e[1]))}t[0]&&this.rInfosPending.push(t),n[0]&&(this.host.settings.useImmediateCalls?ee.callBoundariesBy(n):this.rCallsPending.push(n))}this._afterUpdate&&this.callAndClear('_afterUpdate'),this.triggerRefreshFor('render',e),delete this._isUpdating}updateBoundary(t,o=!1,s,r){let i=!!o,a='all'===o,d=[],l=[];const c=t.component,u=!t.isMounted;if(u){if(null===t.isMounted)return null;l.push([t,'mounted']),i=!0}const f=t._outerDef.props!==c.props?c.props||{}:void 0;f&&(c.props=t._outerDef.props);const h=c.constructor.api;if(h&&(u||f)&&(u&&h.onBuildProps&&!h.builtProps&&(h.builtProps=h.onBuildProps(null)),h.getMixedProps&&(u||c._lastState||(c._lastState=Object.assign({},c.state)),c.state=h.getMixedProps(c))),!u&&c.signals.beforeUpdate&&e.callListeners(c.signals.beforeUpdate),t._forceUpdate&&('all'===t._forceUpdate&&(a=!0),i=!0,delete t._forceUpdate),!u){const o=c._lastState;if(delete c._lastState,i||f||o){if(!i){const n=c.signals.shouldUpdate?e.askListeners(c.signals.shouldUpdate,[c,f,o],['first-true','no-false']):null;(!0===n||null==n&&ee.shouldUpdateBy(t,f,o))&&(i=!0)}const r='moved'===t._outerDef.action;if(r&&l.push([t,'moved']),i&&l.push([t,'updated',f,o]),r)for(const e of n(t.treeNode,!0,!0)){if(s){if(-1!==s.indexOf(e))continue;s.push(e)}d.push({treeNode:e,move:!0})}c.signals.preUpdate&&e.callListeners(c.signals.preUpdate,[f,o,i])}}if(i){const[e,n]=z(t,a);d=d.concat(e),l=l.concat(n)}if(c.wired)for(const e of c.wired){if(e.api.onBuildProps){const t=e.api.builtProps;if(e.api.builtProps=e.api.onBuildProps(t),t===e.api.builtProps)continue}if(e.api.components.size){r||(r=new Set);for(const t of e.api.components)t.boundary._outerDef.props=Object.assign({},t.boundary._outerDef.props),r.add(t.boundary)}}const p='Remote'===t.component.constructor.MIX_DOM_CLASS;if(r&&r.size){const e=S(r,!0);d=d.concat(e[0]),l=l.concat(e[1])}return p&&t.component.refreshSource(),d[0]||l[0]?[d,l]:null}absorbChanges(e,t,n){e&&this.rInfosPending.push(e),t&&(this.host.settings.useImmediateCalls?ee.callBoundariesBy(t):this.rCallsPending.push(t)),this.triggerRefreshFor('render',n)}runRender(){this.renderTimer=null;const e=this.rInfosPending;this.rInfosPending=[];for(const t of e)t[0]&&this.renderer.applyToDOM(t);const t=this.rCallsPending;this.rCallsPending=[];for(const e of t)e[0]&&ee.callBoundariesBy(e);this._afterRender&&this.callAndClear('_afterRender')}triggerRefreshFor(t,n){'update'===t?this.updateTimer=e.updateCallTimer((()=>this.runUpdates()),this.updateTimer,this.host.settings.updateTimeout,n):this.renderTimer=e.updateCallTimer((()=>this.runRender()),this.renderTimer,this.host.settings.renderTimeout,n)}static shouldUpdateBy(t,n,o){var s,r,i;const a=t.component,d=t.host.settings.updateComponentModes,l=null===(s=a.constructor.api)||void 0===s?void 0:s.updateModes,c=n&&o?['props','state']:n?['props']:o?['state']:[];for(const t of c){const s=null!==(i=null!==(r=a.updateModes&&a.updateModes[t])&&void 0!==r?r:l&&l[t])&&void 0!==i?i:d[t],c='number'==typeof s?s:e.CompareDataDepthEnum[s]||0;if(c<-1){if(-2===c)return!0}else{if(0===c)return!0;if(!e.areEqual('state'===t?o:n,a[t],c))return!0}}return!1}callAndClear(e){const t=this[e];delete this[e];for(const e of t)e()}static callBoundariesBy(t){for(const n of t){const[t,o,s,r]=n,i=t.component,a='mounted'===o?'didMount':'moved'===o?'didMove':'didUpdate';i.signals[a]&&e.callListeners(i.signals[a],'updated'===o?[s,r]:void 0)}}}class te{constructor(){this.hosts=new Set,this.contexts={}}}class ne extends e.ContextAPI{setContext(e,t,n=!0,o=!1){return o&&(t?this.host.shadowAPI.contexts[e]=t:delete this.host.shadowAPI.contexts[e]),super.setContext(e,t,n)}setContexts(e,t=!0,n=!1){if(n){const t=this.host.shadowAPI.contexts;for(const n in e)e[n]?t[n]=e[n]:delete t[n]}return super.setContexts(e,t)}afterRefresh(e,t,n){return this.host.afterRefresh(e,t,n)}getListenersFor(e,t){const n=e+'.'+(t||''),o=[...this.host.contextComponents];if(!t){let t=[];for(const e in this.signals)e.startsWith(n)&&(t=t.concat(this.signals[e]));return t.concat(o.reduce(((t,o)=>{if(void 0!==o.contextAPI.contexts[e])return t;const s=o.contextAPI.signals;for(const e in s)e.startsWith(n)&&(t=t.concat(s[e]));return t}),[]))}const s=(this.signals[n]||[]).concat(o.filter((t=>t.contextAPI.signals[n]&&void 0===t.contextAPI.contexts[e])).map((e=>e.contextAPI.signals[n])).reduce(((e,t)=>e.concat(t)),[]));return s[0]&&s}callDataListenersFor(t=!0){if(this.callDataBy(t),this.host.contextComponents.size){const n=e.ContextAPI.readContextNamesFrom(!0===t?Object.keys(this.contexts):t);for(const e of this.host.contextComponents)n.some((t=>void 0===e.contextAPI.contexts[t]))&&e.contextAPI.callDataBy(t)}}}class oe{constructor(e,t,n,o,s){this.constructor.idCount++,this.shadowAPI=s||new te,this.contextComponents=new Set,this.contextAPI=new ne,this.contextAPI.host=this,o&&this.contextAPI.setContexts(o,!1,!0),this.groundedTree={type:'root',parent:null,children:[],domNode:t||null,sourceBoundary:null},this.settings=oe.getDefaultSettings(),n&&oe.modifySettings(this.settings,n),this.services=new ee(this);const r=y({MIX_DOM_DEF:'boundary',tag:this.services.createRoot(e),props:{},childDefs:[]},null),i={type:'boundary',def:r,sourceBoundary:null,boundary:null,parent:this.groundedTree,children:[],domNode:null};this.groundedTree.children.push(i),this.rootBoundary=new W(this,r,i),i.boundary=this.rootBoundary,this.rootBoundary.reattach(),this.services.absorbUpdates(this.rootBoundary,{})}clearRoot(e=!0,t,n){this.services.clearRoot(!0),e&&this.rootBoundary.update(!0,t,n)}moveRoot(e,t){if(this.groundedTree.domNode===e)return;this.groundedTree.domNode=e;const o=n(this.rootBoundary.treeNode,!0).map((e=>({treeNode:e,move:!0})));(o[0]||void 0!==t)&&this.services.absorbChanges(o,null,t)}updateRoot(e,t,n){this.services.updateRoot(e,t,n)}refreshRoot(e=!1,t,n){this.services.refreshRoot(e,t,n)}refreshDOM(e=!1,t){const n=!e||'read',o=[];let s,r=[...this.groundedTree.children],i=0;for(;s=r[i];)i+=1,s.domProps&&o.push({treeNode:s,refresh:n}),s.children[0]&&(r=s.children.concat(r.slice(i)),i=0);this.services.absorbChanges(o,null,t)}afterRefresh(e=!1,t,n){return new Promise((o=>this.afterRefreshCall(o,e,t,n)))}afterRefreshCall(e,t=!1,n,o){this.services.hasPending(!0,t)?(this.addRefreshCall(e,t),this.services.triggerUpdates(n,o)):e()}addRefreshCall(e,t=!1){const n=t?'_afterRender':'_afterUpdate';(this.services[n]||(this.services[n]=[])).push(e)}triggerRefresh(e,t){this.services.triggerUpdates(e,t)}pause(){this.services.renderer.pause()}resume(){this.services.renderer.resume()}isPaused(){return this.services.renderer.paused}rehydrate(e=null,t=!1,n=!1,o=!1,s,r){this.services.renderer.rehydrate(e||this.groundedTree.domNode,t,n,o,s,r)}rehydrateWith(e,t=null,n=!1,o=!1,s=!1,r,i){this.pause(),this.updateRoot(e,null,null),this.services.renderer.rehydrate(t||this.groundedTree.domNode,n,o,s,r,i)}readAsString(){return N.readAsString(this.rootBoundary.treeNode)}getRootElement(){return this.rootBoundary&&this.rootBoundary.treeNode.domNode}getRootElements(e){return this.rootBoundary?n(this.rootBoundary.treeNode,e,!1).map((e=>e.domNode)):[]}queryElement(e,t=!1){return o(this.groundedTree,e,!0,t)}queryElements(e,t=0,n=!1){return s(this.groundedTree,e,t,!0,n)}findElements(e=0,n=!1,o){return t(this.groundedTree,{dom:!0},e,!0,n,o).map((e=>e.domNode))}findComponents(e=0,n=!1,o){return t(this.groundedTree,{boundary:!0},e,!0,n,o).map((e=>e.boundary&&e.boundary.component))}findTreeNodes(n,o=0,s=!1,r){return t(this.groundedTree,n&&e.buildRecordable(n),o,!0,s,r)}modifySettings(e,t=!0){const n=this.settings.onlyRunInContainer;if(oe.modifySettings(this.settings,e),void 0!==e.onlyRunInContainer&&e.onlyRunInContainer!==n&&this.refreshRoot(!1,null,null),t)for(const t of this.shadowAPI.hosts)t!==this&&t.modifySettings(e,!1)}static modifySettings(e,t,n=!1){var o;let s=null;if(t.updateComponentModes){const e=t.updateComponentModes,n={};for(const t in e)n[t]=null!==(o=e[t])&&void 0!==o?o:(s||(s=oe.getDefaultSettings())).updateComponentModes[t];t=Object.assign(Object.assign({},t),{updateComponentModes:n})}for(const o in t)void 0!==t[o]?e[o]=t[o]:n&&(e[o]=(s||(s=oe.getDefaultSettings()))[o])}static getDefaultSettings(){return{updateTimeout:0,renderTimeout:0,useImmediateCalls:!1,updateComponentModes:{props:'shallow',state:'shallow'},preCompareDOMProps:'if-needed',wideKeysInArrays:!1,noRenderValuesMode:!1,onlyRunInContainer:!1,disableRendering:!1,duplicateDOMNodeBehaviour:'deep',duplicateDOMNodeHandler:null,duplicatableHost:!1,maxReRenders:1,renderTextTag:'',renderHTMLDefTag:'span',renderTextHandler:null,renderSVGNamespaceURI:'http://www.w3.org/2000/svg',renderDOMPropsOnSwap:!0,devLogWarnings:!1,devLogRenderInfos:!1}}}oe.MIX_DOM_CLASS='Host',oe.idCount=0;var se;class re{constructor(e){}}re.MIX_DOM_CLASS='Fragment';class ie{constructor(e){}}ie.MIX_DOM_CLASS='Portal';class ae{constructor(e){}}ae.MIX_DOM_CLASS='Element';class de{constructor(e){}render(){return null}}de.MIX_DOM_CLASS='Empty';const le=((se=class extends de{static isRemote(){return!1}}).Content=null,se.ContentCopy=null,se.copyContent=e=>null,se.WithContent=(e,t)=>null,se);class ce extends e.SignalMan{constructor(){super(),this.components=new Set}update(e=!0,t,n){for(const o of this.components)o.triggerUpdate(e,t,n)}onListener(e,t,n){if(super.onListener(e,t,n),this.components.size){const o=this.signals[e][t],s=o[0];if(n)for(const t of this.components)t.listenTo(e,((...e)=>o[1]?s(t,...e,...o[1]):s(t,...e)),null,o[2],s);else for(const t of this.components)t.unlistenTo(e,s)}}}class ue extends ce{constructor(){super(),this.updateModes={props:'never'},this.builtProps=null}buildProps(){return this.onBuildProps?this.onBuildProps(this.builtProps):this.builtProps}getMixedProps(e){return this.onMixProps?this.onMixProps(e.props,this.builtProps,e):Object.assign(Object.assign({},e.props),e.state)}setProps(e,t,n,o){(this.builtProps!==e||t||void 0!==n||void 0!==o)&&(this.builtProps=e,this.update('trigger'!==t&&t,n,o))}refresh(e,t,n){this.setProps(this.buildProps(),e,t,n)}update(e=!0,t,n){for(const o of this.components)o.setState(this.getMixedProps(o),e,t,n)}}var fe;const he=e=>{var t;const n=null===(t=e.contentPass)||void 0===t?void 0:t.envelope;return n&&M(n.applied.childDefs,he)||!1},pe=((fe=class extends X{hasContent(){var e;const t=null===(e=this.boundary.sourceBoundary)||void 0===e?void 0:e.closure;return t&&t.envelope&&M(t.envelope.applied.childDefs,he)||!1}render(){var e;return(null!==(e=this.props.hasContent)&&void 0!==e?e:this.hasContent())?b:null}})._WithContent=b,fe);function me(...e){const t=e.length,n=!0===e[t-1],o=n||!e[t-1]?e.slice(0,t-1):e,s=(e,t,s)=>{let r=null;for(const n of o){if(!n)continue;const o=t.state,i=n(e,t,s);'function'!=typeof i&&'function'==typeof r||(r=i),o!==t.state&&t.state&&(t.state=Object.assign(Object.assign({},o||{}),t.state))}return n?()=>r:r};let r=!1;const i=o.filter((e=>(r=r||e.length>2,e.api))).map((e=>e.api)),a=r?(e,t,n)=>s(e,t,n):(e,t)=>s(e,t);return i[0]&&(a.api=function(e){const t=e.some((e=>e instanceof ue))?new ue:new ce;for(const n of e){if(n.updateModes){t.updateModes||(t.updateModes={});for(const e in n.updateModes)t.updateModes[e]=Object.assign(Object.assign({},t.updateModes[e]),n.updateModes[e])}for(const e in n.signals)t.signals[e]=[...t.signals[e]||[],...n.signals[e]];n instanceof ue&&(n.builtProps&&(t.builtProps=n.builtProps),n.onBuildProps&&(t.onBuildProps=n.onBuildProps),n.onMixProps&&(t.onMixProps=n.onMixProps))}return t}(i)),a}function ge(...e){const t=e[0].MIX_DOM_CLASS?e[0]:null;let n=t||X;for(const o of t?e.slice(1):e)n=o(n);return n}function ye(e,...t){const n='function'!=typeof t[t.length-1]&&!!t.pop(),o=t.length>1?me(...t):t[0];return{[e.name]:class extends e{render(e){const t=o(e,this,this.contextAPI);return n?super.render:'function'==typeof t?t:()=>t}}}[e.name]}const De=(t,n)=>new e.Context(t,n),Me={def:m,defHTML:(e,t,n,o)=>{const s={MIX_DOM_DEF:'content',tag:t||'',childDefs:[],domContent:e,domHTMLMode:!0};return t&&n&&(s.props=l(n)),null!=o&&(s.key=o),s},Content:b,WithContent:pe,ContentCopy:v,copyContent:function(e){return D(e,!0)},Component:X,ComponentMixin:F,Host:oe,Ref:_,Fragment:re,Portal:ie,Element:ae,Empty:de,EmptyRemote:le,newHost:(e,t,n,o)=>new oe(e,t,n,o),newRef:()=>new _,newContext:De,newContexts:(e,t)=>{const n={};for(const o in e)n[o]=De(e[o],t);return n},component:j,componentWith:U,shadow:function(e,t,n=e.name){const o=e.MIX_DOM_CLASS?{[n]:class extends e{}}[n]:j(e,n);if(o.api=new ce,t)for(const e in t)o.api.listenTo(e,t[e]);return o},shadowWith:(e,t,n=e.name)=>{const o=U(e,n);if(o.api=new ce,t)for(const e in t)o.api.listenTo(e,t[e]);return o},spread:e=>e.length>1?(t,...n)=>e(t,...n):e,spreadWith:e=>e.length>1?(t,...n)=>e(t,...n):e,remote:()=>{var e,t;return e=class e extends X{canRefresh(){return e.source===this}preRefresh(t){return e.source===this&&$(e.closure,t,this)||null}applyRefresh(t=!1){return e.source===this&&J(e.closure,t)||[[],[]]}reattachSource(){return e.reattachSourceBy(this)}refreshSource(t){e.refreshRemote(t)}render(){return null}static isRemote(){return!0}static addSource(t){e.sources.add(t)}static removeSource(t,n=!0){if(e.sources.delete(t),e.source!==t)return null;let o=null;const s=I(e.closure,t);return o=Z(e.closure,null),e.source=null,e.closure.sourceBoundary=null,(n||s)&&t.boundary.host.addRefreshCall((()=>{if(s)for(const e of s)e.host.services.absorbUpdates(e,{force:!0});n&&e.refreshRemote()}),!0),o}static getBestRemote(t=!0){var n;const o=e.sources,s=o.size;if(s<2)return s&&[...o][0]||null;let r=-1/0,i=null;for(const e of o){const t=e.boundary._outerDef.props.importance||0;t>r&&(i=e,r=t)}return t&&r===(null===(n=e.source)||void 0===n?void 0:n.boundary._outerDef.props).importance&&e.source||i}static reattachSourceBy(t){const n=e.source;if(n===t||(t.boundary._outerDef.props.importance||0)<=(n?n.boundary._outerDef.props.importance||0:-1/0))return null;let o=null;const s=t.boundary;return n&&(o=Z(e.closure,null),o&&s.host!==n.boundary.host&&(n.boundary.host.services.absorbChanges(o[0],o[1],null),o=null)),e.source=t,e.closure.sourceBoundary=s,s.closure.envelope&&(o=P(o,Z(e.closure,s.closure.envelope))),o}static refreshRemote(t){const n=e.getBestRemote(),o=e.source||null;if(n===o)return;const s=e.closure,r=n?(o=!0)=>{const r=n.boundary;if(r.closure.envelope===s.envelope||o&&e.source!==n)return;e.source=n,s.sourceBoundary=r;const[i,a]=Z(s,r.closure.envelope);(i[0]||a[0])&&r.host.services.absorbChanges(i,a,o?null:t)}:null;if(o){const i=o.boundary.host;let a=Z(s,null);e.source=n,s.sourceBoundary=n&&n.boundary,a[0][0]||a[1][0]?(r&&i.addRefreshCall(r,!1),i.services.absorbChanges(a[0],a[1],t)):r&&r()}else r&&r(!1)}},e.MIX_DOM_CLASS='Remote',e.closure=new B,e.source=null,e.sources=new Set,e.Content=Object.assign(Object.assign({},D(e)),{contentPass:null,getRemote:()=>e}),e.ContentCopy=Object.assign(Object.assign({},D(e,!0)),{contentPass:null,getRemote:()=>e}),e.copyContent=t=>Object.assign(Object.assign({},D(null!=t?t:e,!0)),{contentPass:null,getRemote:()=>e}),e.WithContent=((t=class extends X{render(){var t;return(null!=this.props.hasContent?this.props.hasContent:null===(t=e.source)||void 0===t?void 0:t.boundary.closure.hasContent())?b:null}})._WithContent=e.Content,t),e},wired:function(...e){const t=e.length,n='string'==typeof e[t-1]?-1:0,o=e[t-3+n],s=e[t-2+n]||null,r=e[t-1+n],i=n?e[t-1]:r.name,a={[i]:(e,t)=>m(r,Object.assign({},t.state),b)}[i];return a.api=new ue,o&&('object'==typeof o?a.api.builtProps=o:t>2&&'function'==typeof o&&(a.api.onBuildProps=o)),s&&(a.api.onMixProps=s),a},mixin:function(e){return e},mixFuncs:me,mixFuncsWith:function(...e){const t=e.length;return'function'!=typeof e[t-1]?me(...e.slice(0,t-1),!0):me(...e,!0)},mixClassFuncs:ye,mixClassFuncsWith:function(...e){const t=e.length;return ye(...'function'!=typeof e[t-1]?e.slice(0,t-1):e)},mixClassMixins:function(...e){return ge(...e)},mixMixins:ge,mixMixinsWith:function(...e){const t=e.length;return'function'!=typeof e[t-1]?ge(...e.slice(0,t-1)):ge(e)},mixHOCs:function(e,...t){let n=e;for(const e of t)n=e(n);return e=>m(n,e,b)},findTreeNodesIn:(n,o,s,r,i,a)=>t(n,o&&e.buildRecordable(o),s,r,i,a),findComponentsIn:(e,n,o,s,r)=>t(e,{boundary:!0},n,o,s,r).map((e=>e.boundary&&e.boundary.component)),findElementsIn:(e,n,o,s,r)=>t(e,{dom:!0},n,o,s,r).map((e=>e.domNode)),queryElementIn:(e,t,n,s)=>o(e,t,n,s),queryElementsIn:(e,t,n,o,r)=>s(e,t,n,o,r),readAsString:e=>{const t=e&&(e.constructor.MIX_DOM_CLASS?e.boundary.treeNode:e.treeNode||'string'==typeof e.type&&e);return t?N.readAsString(t):''},classNames:function(...e){const t={};for(const n of e)n&&u(n,t,' ');return Object.keys(t).join(' ')},parseStyle:c};window.MixDOM=Me}();
