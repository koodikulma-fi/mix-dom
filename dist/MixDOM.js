var e=require('data-signals'),t=require('dom-types');function n(e,t,n=0,o=!1,s=!1,r){const i=[];let d,a=[e],l=0;const c=e.boundary;for(;d=a[l];)if(l++,!d.boundary||null!==d.boundary.isMounted){if((!t||t.has(d.type))&&(!r||r(d))){const e=i.push(d);if(n&&e>=n)return i}d.boundary&&!o&&d.boundary!==c||('host'!==d.type||s)&&d.children[0]&&(a=d.children.concat(a.slice(l)),l=0)}return i}function o(e,t=!1,n=!1,s=0){let r=[];for(const i of e.children)if(i.domNode||n)switch(i.type){case'dom':if(r.push(i),s&&r.length>=s)return r;break;case'boundary':case'pass':case'host':if(!t)break;case'root':if(r=r.concat(o(i,t,n,s&&s-r.length)),s&&r.length>=s)return r.slice(0,s)}return r}function s(e,t=!1){var n,o;const s=[];let r,i=[e],d=0;for(;r=i[d++];)r.updateId&&t&&r.updateId===(null===(o=null===(n=r.treeNode)||void 0===n?void 0:n.sourceBoundary)||void 0===o?void 0:o.host.services._whileUpdating)||s.push(r),r.childDefs[0]&&(i=r.childDefs.concat(i.slice(d)),d=0);return s}function r(e,t,o=!1,s=!1){const r=n(e,new Set(['dom']),1,o,s,(e=>e.domNode&&e.domNode instanceof Element&&e.domNode.matches(t)))[0];return r&&r.domNode||null}function i(e,t,o=0,s=!1,r=!1){return n(e,new Set(['dom']),o,s,r,(e=>e.domNode&&e.domNode instanceof Element&&e.domNode.matches(t))).map((e=>e.domNode))}var d=(e,t)=>{var n={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(n[o]=e[o]);if(null!=e&&'function'==typeof Object.getOwnPropertySymbols){var s=0;for(o=Object.getOwnPropertySymbols(e);s<o.length;s++)t.indexOf(o[s])<0&&Object.prototype.propertyIsEnumerable.call(e,o[s])&&(n[o[s]]=e[o[s]])}return n};const a={};function l(e,n=null,...o){const s=function(e){if('string'==typeof e)return'dom';const t=e.MIX_DOM_CLASS;if(!t)return'function'==typeof e?e.length>=2?'boundary':'spread':'';switch(t){case'Component':case'Remote':return'boundary';case'Fragment':case'Portal':case'Element':case'Host':return t.toLowerCase();default:return''}}(e);if(!s||n&&n._disable)return null;const r=[];let i=!1,a=0;for(const e of o){let t='string'==typeof e;if(e&&t&&i){r[a-1].domContent+=e;continue}const n=c(e);n&&(a=r.push(n),i=t)}if('spread'===s)return function(e,t,n){var o;const{_key:s,_disable:r}=t,i=d(t,['_key','_disable']);let a=c(e(i));if(!a)return null;const l={passes:[],withs:[]},u={MIX_DOM_DEF:'fragment',childDefs:[Object.assign({},a)],scopeType:'spread',spreadLinks:l,tag:null};null!=s&&(u.key=s);null!=r&&(u.disabled=r);let f,h=[u],m=!1,g=0;const y=!!n[0];for(;f=h[g];){if(g++,!f.childDefs[0])continue;let e=[];const t=f.childDefs;f.childDefs=[];for(const s of t){let t;if(s.spreadLinks){t=s,e=e.concat(s.spreadLinks.passes);for(const[e,t]of s.spreadLinks.withs){const n=e&&p(e,y);t.props.hasContent=!!n,'maybe'===n&&l.withs.push([e,t])}}else if('pass'===s.MIX_DOM_DEF)s.getRemote?t=s:(t={MIX_DOM_DEF:'fragment',tag:null,childDefs:[...n]},null!=s.key&&(t.key=s.key),m||'copy'===s.contentPassType?t.scopeType='spread-copy':(t.scopeType='spread-pass',m=!0),l.passes.push(t));else if(t=Object.assign({},s),e.push(t),'boundary'===s.MIX_DOM_DEF&&s.tag._WithContent&&!s.tag._WithContent.getRemote&&!s.tag.withContents&&null==(null===(o=t.props)||void 0===o?void 0:o.hasContent)){const e=p(n,y);t.props=Object.assign({hasContent:!!e},t.props),'maybe'===e&&l.withs.push([n,t])}f.childDefs.push(t)}h=e.concat(h.slice(g)),g=0}return u}(e,n||{},r);if('fragment'===s&&!r[0])return null;const l='dom'===s&&e||'boundary'===s&&e||'element'===s&&'_'||('content'===s?'':null),u={MIX_DOM_DEF:s,tag:l,childDefs:r};if('fragment'===u.MIX_DOM_DEF);else if(n){const{_key:e,_ref:o,_signals:r,_contexts:i,_disable:a}=n,c=d(n,['_key','_ref','_signals','_contexts','_disable']);if(null!=e&&(u.key=e),o){const e=[];if('Ref'===o.constructor.MIX_DOM_CLASS)e.push(o);else for(const t of o)t&&'Ref'===t.constructor.MIX_DOM_CLASS&&-1===e.indexOf(t)&&e.push(t);u.attachedRefs=e}r&&(u.attachedSignals=Object.assign({},r)),i&&'boundary'===s&&(u.attachedContexts=Object.assign({},i)),l&&(u.props='string'==typeof l?t.cleanDOMProps(c):c)}else l&&(u.props={});switch(u.MIX_DOM_DEF){case'portal':u.domPortal=n.container||null;break;case'element':{const e=u.props||{},{element:n,cloneMode:o}=e,s=d(e,['element','cloneMode']);u.props=t.cleanDOMProps(s),u.domElement=n||null,u.domCloneMode=null!=o?'boolean'==typeof o?o?'deep':'':o:null;break}}return u}function c(e){if(e&&'object'==typeof e){if('string'==typeof e.MIX_DOM_DEF)return e;if(e instanceof Node)return{MIX_DOM_DEF:'content',tag:'',childDefs:[],domContent:e};if('Host'===e.constructor.MIX_DOM_CLASS)return{MIX_DOM_DEF:'host',tag:null,host:e,key:e,childDefs:[]};if(Array.isArray(e)||e instanceof HTMLCollection||e instanceof NodeList){const t=[...e].map((e=>c(e))).filter((e=>e));return t.length?{MIX_DOM_DEF:'fragment',tag:null,isArray:!0,childDefs:t}:null}e=String(e)}return null!=e?{MIX_DOM_DEF:'content',tag:'',domContent:e,childDefs:[]}:null}function u(e,t){const n={MIX_DOM_DEF:e.MIX_DOM_DEF,tag:e.tag,childDefs:[],action:'mounted'};return null!=e.key&&(n.key=e.key),'fragment'===n.MIX_DOM_DEF?(e.isArray&&(n.isArray=!0),e.scopeType&&(n.scopeType=e.scopeType)):'pass'===n.MIX_DOM_DEF?e.getRemote?(n.getRemote=e.getRemote,n.contentPass=e.contentPass||null):n.contentPass=e.contentPass||t||null:e.host&&(n.host=e.host),n}function f(e,t){const n={MIX_DOM_DEF:'pass',tag:null,childDefs:[],contentPassType:t?'copy':'pass'};return null!=e?n.key=e:t||(n.key=a),n}function p(e,t){let n=!1;for(const o of e){if(o.disabled)continue;const e='fragment'===o.MIX_DOM_DEF?p(o.childDefs,t):'pass'!==o.MIX_DOM_DEF||('function'==typeof t?t(o):t&&'maybe');if(e){if(!0===e)return!0;n='maybe'}}return n}const h=f(),m=f({},!0);class g extends e.SignalMan{constructor(...e){super(...e),this.treeNodes=new Set}getTreeNode(){return[...this.treeNodes][this.treeNodes.size-1]||null}getTreeNodes(){return[...this.treeNodes]}getElement(e=!1){let t=this.treeNodes.size-1;const n=[...this.treeNodes];for(;t>=0;){const o=n[t];if(o.domNode&&(!e||'dom'===o.type))return o.domNode}return null}getElements(e=!1){let t=[];for(const n of this.treeNodes)n.domNode&&('dom'===n.type?t.push(n.domNode):e||(t=t.concat(o(n,!0).map((e=>e.domNode)))));return t}getComponent(){var e;const t=[...this.treeNodes][this.treeNodes.size-1];return t&&'boundary'===t.type&&(null===(e=t.boundary)||void 0===e?void 0:e.component)||null}getComponents(){var e;const t=[];for(const n of this.treeNodes)'boundary'===n.type&&(null===(e=n.boundary)||void 0===e?void 0:e.component)&&t.push(n.boundary.component);return t}static onListener(e,t,n,o){if(e.treeNodes.size){const s=e.signals[t][n],r=s[0];if(o)for(const n of e.getComponents())n.listenTo(t,((...e)=>s[1]?r(n,...e,...s[1]):r(n,...e)),null,s[2],r);else for(const n of e.getComponents())n.unlistenTo(t,r)}}static didAttachOn(t,n){var o;if(!t.treeNodes.has(n))if(t.treeNodes.add(n),'boundary'===n.type){const s=null===(o=n.boundary)||void 0===o?void 0:o.component;for(const e in t.signals)for(const n of t.signals[e]){const[t,o,r]=n;s.listenTo(e,((...e)=>o?t(s,...e,...o):t(s,...e)),null,r,t)}s&&t.signals.didAttach&&e.callListeners(t.signals.didAttach,[s])}else'dom'===n.type&&n.domNode&&t.signals.domDidAttach&&e.callListeners(t.signals.domDidAttach,[n.domNode])}static willDetachFrom(t,n){var o;if(t.treeNodes.has(n))if('boundary'===n.type){const s=null===(o=n.boundary)||void 0===o?void 0:o.component;if(s){t.signals.willDetach&&e.callListeners(t.signals.willDetach,[s]);for(const e in t.signals)for(const n of t.signals[e])s.unlistenTo(e,n[0])}}else'dom'===n.type&&n.domNode&&t.signals.domWillDetach&&e.callListeners(t.signals.domWillDetach,[n.domNode]);t.treeNodes.delete(n)}}g.MIX_DOM_CLASS='Ref';class y{constructor(e,t){this.hydrationRoot=t||null,this.paused=e.disableRendering,this.settings=e,this.externalElements=new Set,this.inBrowser='object'==typeof document}pause(){this.paused=!0}resume(){this.paused&&(this.paused=!1,this.hydrationRoot&&this.rehydrate(null,!0))}rehydrate(e=null,n=!1,s=!1,r=!1,i,d){var a,l,c;const u=this.hydrationRoot;if(!u)return void(this.settings.devLogWarnings&&console.warn('__HostRender.rehydrate: Warning: No hydration root assigned. ',this));let f=null;const p={};if(e&&(f={tag:(null===(a=e.tagName)||void 0===a?void 0:a.toLowerCase())||'',node:e,parent:null,used:!0},e.childNodes[0])){let t,n=[[[...e.childNodes],f]],o=0;for(;t=n[o];){o++;const[e,s]=t;s.children||(s.children=[]);let r=[];for(const t of e){const e={tag:(null===(l=t.tagName)||void 0===l?void 0:l.toLowerCase())||'',node:t,parent:s},n=t instanceof Element?t.getAttribute('_key'):null;null!=n&&(e.key=n,(p[e.tag]||(p[e.tag]=[])).push(e)),s.children.push(e),t.childNodes[0]&&r.push([[...t.childNodes],e])}r[0]&&(n=r.concat(n.slice(o)),o=0)}}const h=new Set(this.externalElements);e&&h.add(e);let m,g=[[u,f]],D=0;const C=[];for(;m=g[D];){D++;let[e,o]=m;if('dom'===e.type){let r=e.domNode;const a=y.getTreeNodeMatch(e,o,p,h,i,d);if(a){let t=null;a instanceof Node?t=a:(o=a,o.used=!0,t=o.node),!t||e.domNode&&!s||(r=t)}r&&h.add(r);const l={treeNode:e};let c=n;if(r!==e.domNode&&(c=!0,e.domNode?r&&(l.swap=r):l.create=!0),!l.create&&r){const[n,o]=y.findInsertionNodes(e);r.parentNode===n&&r.nextSibling===o||(l.move=!0),'content'===e.def.MIX_DOM_DEF?l.content=!0:(c&&(e.domProps=t.readFromDOM(r)),l.update=!0)}(l.create||l.swap||l.move||l.update||l.content)&&C.push(l)}e.children[0]&&(g=e.children.map((e=>[e,o])).concat(g.slice(D)),D=0)}if(this.settings.disableRendering||(this.paused=!1),r&&e){let t,n=e===u.domNode?o(u.children[0],!0).map((e=>e.domNode)).filter((e=>e)):[...e.childNodes],s=0;for(;t=n[s];)s++,h.has(t)?t.childNodes[0]&&(n=[...t.childNodes,...n.slice(s)],s=0):null===(c=t.parentNode)||void 0===c||c.removeChild(t)}if(C[0]&&this.applyToDOM(C),this.pausedPending){const e=this.pausedPending.filter((e=>e.treeNode.domNode&&!h.has(e.treeNode.domNode)));delete this.pausedPending,e[0]&&this.applyToDOM(e)}}applyToDOM(n){var o;if(this.paused){const e=n.filter((e=>e.remove));return void(e[0]&&(this.pausedPending=(this.pausedPending||[]).concat(e)))}const s=this.settings;let r=null,i=null,d=null;for(const a of n){const n=a.treeNode,l=n.def.attachedSignals,c=n.def.attachedRefs;if(a.remove){if('dom'===n.type&&n.domNode){const t=n.domNode,o=t.parentNode;let s=!1;if((null==l?void 0:l.domWillUnmount)&&l.domWillUnmount(t)&&(s=!0),c)for(const o of c)o.signals.domWillUnmount&&e.askListeners(o.signals.domWillUnmount,[t],['no-false','last'])&&(s=!0),g.willDetachFrom(o,n);s?d?d.push(t):d=[t]:!o||i&&-1!==i.indexOf(o)||d&&d.some((e=>e.contains(t)))||o.removeChild(t);const r='element'===n.def.MIX_DOM_DEF;(r||'content'===n.def.MIX_DOM_DEF)&&this.externalElements.delete(t),r||(i||(i=[])).push(t),n.domNode=null,y.updateDOMChainBy(n,null)}continue}let u=!1,f=!1;if(a.refresh&&n.domNode&&n.domProps&&(n.domProps='read'===a.refresh?t.readFromDOM(n.domNode):{},u=!0),a.create)switch(n.type){case'dom':const e=this.createDOMNodeBy(n);e&&(n.domNode=e,f=!0);break;case'portal':n.domNode=n.def.domPortal||null}if(f||a.move)if('host'===n.type){const e=n.def.host||null;e&&e.services.refreshRoot(!1,null,null),n.domNode=n.parent&&e&&e.getRootElement()||null,y.updateDOMChainBy(n,n.domNode)}else n.domNode&&(r||(r=[])).push(a);if(a.swap){const e=!0!==a.swap,r=n.domNode;let i=e?a.swap:('portal'===n.type?n.def.domPortal:n.def.domElement)||null;if(r!==i){if(!e&&'dom'===n.type){const e=n,d=r&&r.parentNode;if(i&&(i=this.getApprovedNode(i,e),i)){let[e,t]=d?[d,r]:y.findInsertionNodes(n);e&&e.insertBefore(i,t)}if(r){if(this.externalElements.delete(r),(null===(o=e.domProps)||void 0===o?void 0:o.listeners)&&r instanceof Element){const t=e.domProps.listeners;for(const e in t)t[e]&&r.removeEventListener(e,t[e])}d&&d.removeChild(r)}e.domProps&&(e.domProps=i&&'read'===s.renderDOMPropsOnSwap?t.readFromDOM(i):{},u=!0)}for(const e of n.children){const t=e.domNode;t&&(t.parentNode&&t.parentNode.removeChild(t),i&&i.appendChild(t))}n.domNode=i,y.updateDOMChainBy(n,i)}}if(a.content&&'dom'===n.type&&n.domNode){const t=n.def.domContent,o=n.domNode;let r=o;if('content'===n.def.MIX_DOM_DEF){if(n.def.domHTMLMode&&null!=t&&''!==t)r=y.domNodeFrom(t.toString(),n.def.tag||s.renderHTMLDefTag,!0),r&&n.domProps&&(u=!0,n.domProps={});else{const e=null==t?'':(s.renderTextHandler?s.renderTextHandler(t):t).toString();3!==o.nodeType&&this.inBrowser?r=document.createTextNode(e):o.textContent=e}}else if(t instanceof Node){const e=t.parentNode;e&&e.removeChild(t)}else o.textContent='';if(r&&o!==r){const e=o.parentNode;e&&(n.domNode=r,e.insertBefore(r,o),e.removeChild(o)),y.updateDOMChainBy(n,n.domNode)}if((null==l?void 0:l.domDidContent)&&l.domDidContent(n.domNode,null!=t?t:null),c)for(const o of c)o.signals.domDidContent&&e.callListeners(o.signals.domDidContent,[n.domNode,null!=t?t:null])}if((f||u||a.update)&&'dom'===n.type){const o=n.domNode instanceof Element?n.domNode:null,r=n.def.props||{},i=t.applyDOMProps(n.domNode instanceof Element?n.domNode:null,r,n.domProps||{},s.devLogWarnings);if(n.domProps=r,i&&a.update&&o&&((null==l?void 0:l.domDidUpdate)&&l.domDidUpdate(o,i),c))for(const t of c)t.signals.domDidUpdate&&e.callListeners(t.signals.domDidUpdate,[o,i])}a.emptyMove&&y.updateDOMChainBy(n,null,!0)}if(r){const t=[];let n=null,o=r.length;for(;o--;){const e=r[o],s=e.treeNode,i=s.domNode;if(i){const o=i.parentNode,r=i.nextSibling,[d,a]=i?y.findInsertionNodes(s):[null,null];d===o&&a===r||(d&&t.push([i,d,a]),(s.def.attachedRefs||s.def.attachedSignals)&&(n||(n=[])).push([!e.move,e.treeNode,o,r]),o&&o.removeChild(i))}y.updateDOMChainBy(s,i)}if(t[0])for(const e of t)e[1].insertBefore(e[0],e[2]);if(n){let t=n.length;for(;t--;){const[o,s,r,i]=n[t],{attachedSignals:d,attachedRefs:a}=s.def,l=s.domNode;if(d&&(o?d.domDidMount&&d.domDidMount(l):d.domDidMove&&d.domDidMove(l,r,i)),a)for(const t of a)o?(g.didAttachOn(t,s),t.signals.domDidMount&&e.callListeners(t.signals.domDidMount,[l])):t.signals.domDidMove&&e.callListeners(t.signals.domDidMove,[l,r,i])}}}}getApprovedNode(e,t){let n=e;const o=null!=t.def.domCloneMode?t.def.domCloneMode:this.settings.duplicateDOMNodeBehaviour;return('always'===o||this.externalElements.has(e))&&(n=this.settings.duplicateDOMNodeHandler?this.settings.duplicateDOMNodeHandler(e,t):o?e.cloneNode('deep'===o||'always'===o):null),n&&this.externalElements.add(n),n}createDOMNodeBy(e){var n;const o=e.def.tag;if('string'!=typeof o)return null;if('_'===o)return e.def.domElement&&this.getApprovedNode(e.def.domElement,e)||null;const s=e.def.domContent;if(s instanceof Node)return this.getApprovedNode(s,e);const r=this.settings;if(e.def.domHTMLMode&&null!=s&&''!==s)return y.domNodeFrom(s.toString(),o||r.renderHTMLDefTag,!0);if(o)return this.inBrowser?t.createDOMElement(o,null===(n=e.parent)||void 0===n?void 0:n.domNode,r.renderSVGNamespaceURI):null;let i=null,d='',a='';if(null!=s){a=(r.renderTextHandler?r.renderTextHandler(s):s).toString();const e=r.renderTextTag;if(e)if('string'==typeof e)d=e;else if('function'==typeof e){const t=e(s);t instanceof Node&&(i=t)}}if(!i){if(!this.inBrowser)return null;i=d?document.createElement(d):document.createTextNode(a)}return d&&a&&(i.textContent=a),i}static findInsertionNodes(e){let t=null,n=e.parent;for(;n;){if(!(y.PASSING_TYPES[n.type]||'root'===n.type&&n.parent)){t=n.domNode;break}n=n.parent}if(!t)return[null,null];let o=null,s=e;for(;s&&(n=s.parent,n);){let e,r=n.children.indexOf(s)+1;for(;e=n.children[r];){if(e.domNode&&'portal'!==e.type){o=e.domNode;break}r++}if(o||n.domNode===t)break;s=n}return[t,o]}static updateDOMChainBy(e,t,n=!1){let o=e,s=n?e:e.parent,r=t;for(;s&&(y.PASSING_TYPES[s.type]||s===o);){if(s.children[0]!==o&&s!==o){let e=!1,t=s.children.indexOf(o)-1;for(;t>=0;){if(s.children[t].domNode){e=!0;break}t--}if(e)break}if(!r){let e,t=s.children.indexOf(o)+1;for(;e=s.children[t];){if(e.domNode&&'portal'!==e.type){r=e.domNode;break}t++}if(r&&s.domNode===r)break}s.domNode=r,o=s,s=s.parent}}static domNodeFrom(e,t='div',n=!1){const o=t instanceof Element?t:'object'==typeof document?document.createElement(t):null;return o?(o.innerHTML=e,n||o.children[1]?o:o.children[0]):null}static getTreeNodeMatch(e,t,n,o,s,r){const i=e.def.tag,d=e.def.key;if(r){const n=r(t,e,i,d);if(n){if((n instanceof Element?n.tagName.toLowerCase():'')===i&&(n instanceof Node?!(null==o?void 0:o.has(n)):!(null==o?void 0:o.has(n.node))&&y.isVirtualItemOk(e,n,t,s)))return n}}const a=null!=d;if(t)for(const n of t.used?t.children||[]:[t])if(!n.used&&n.tag===i&&(a?n.key===d:null==n.key)&&!(null==o?void 0:o.has(n.node))&&(!s||s(n,e,i,d)))return n;if(n&&a){const r=n[i];if(r)for(const n of r)if(!n.used&&n.key===d&&!(null==o?void 0:o.has(n.node))&&y.isVirtualItemOk(e,n,t,s))return n}return null}static isVirtualItemOk(e,t,n,o){if(t.tag!==e.def.tag)return!1;const s=e.def;if(n){let r=t;for(;r;){if(r===n)return!o||o(t,e,s.tag,s.key);r=r.parent}}else if(!o||o(t,e,s.tag,s.key))return!0;return!1}}function D(e,...t){for(const n of t)n&&n[0][0]&&(e[0]=e[0].concat(n[0])),n&&n[1][0]&&(e[1]=e[1].concat(n[1]))}function C(e){const t=new Map;for(const n of e){let e=n.bId,o=n.parentBoundary;for(;o;)e=(o.bId||'')+'>'+e,o=o.parentBoundary;const s=t.get(e);if(s){let e=0;if(n.parentBoundary){const t=n.parentBoundary.innerBoundaries,o=t.indexOf(n);for(const n of s){if(o<t.indexOf(n))break;e++}}s.splice(e,0,n)}else t.set(e,[n])}const n=[];for(const e of t.keys()){let t=0,o=!1;for(const s of n){if(s.startsWith(e+'>'))break;if(e.startsWith(s+'>'))o=!0;else if(o)break;t++}n.splice(t,0,e)}let o=0;const s=[];for(const e of n)for(const n of t.get(e))s[o++]=n;return s}function M(e,t=!0){let n=[[],[]];for(const o of t&&e.size>1?C(e):e){if(!o._forceUpdate&&!o.component._lastState&&o.component.props===o._outerDef.props)continue;const e=o.host.services.updateBoundary(o);e&&D(n,e)}return n}function b(e,t){if(t){const e=new Set;if(t.closure.withContents)for(const n of t.closure.withContents)e.add(n);for(const n of t.constructor.WithContent.withContents)e.add(n);return e.size?e:null}if(!e.withContents&&!e.chainedClosures)return null;const n=e.withContents?new Set(e.withContents):new Set;if(e.chainedClosures)for(const t of e.chainedClosures){const e=b(t);if(e)for(const t of e)n.add(t)}return n.size?n:null}y.SIMPLE_TAGS=['img'],y.PASSING_TYPES={boundary:!0,pass:!0,host:!0,fragment:!0};const v={fragment:1,portal:2,pass:3,host:4};function _(e,t,n,o,s){t.children[0]&&(t.children=[]);const r=e.length;if(!r)return[];const i=[];let d=0,a=null,l=t;if(n){if(!t.parent)return[];if(l=t.parent,a=t,d=l.children.indexOf(t),-1===d)return[]}for(let t=0;t<r;t++){const n=e[t];if(n.disabled){d--,i.push(null);continue}let r=null;n.treeNode?r=n.treeNode:'fragment'!==n.MIX_DOM_DEF&&(n.action='mounted'),a&&(r?l.children.splice(d,1):r=a,a=null);const c=n.MIX_DOM_DEF,u='content'===c||'element'===c?'dom':'fragment'===c?'':c;if(r){if(r.parent){const e=r.parent.children.indexOf(r);0===e&&r.parent!==l&&!0===y.PASSING_TYPES[r.parent.type]&&s&&-1===s.indexOf(r.parent)&&s.push(r.parent),-1!==e&&r.parent.children.splice(e,1)}r.parent=l,r.sourceBoundary=o||null,r.type=u}else r={type:u,parent:l,children:[],sourceBoundary:o||null,domNode:null},'dom'===r.type&&(r.domProps={});'fragment'!==n.MIX_DOM_DEF&&(r.def=n,n.treeNode=r),l.children.splice(d+t,0,r),i.push(r)}return i}function N(t,n,o,r,i,d,a){var l,c,f,p,h,m;let g=n.childDefs.length;if(!g)return[];const y=d||!n.isArray;if(!d&&n.isArray!=(t&&t.isArray))return n.childDefs.map((e=>u(e,i&&i.closure||null)));const D=t&&t.childDefs||null,C=[];for(let d=0;d<g;d++){const g=n.childDefs[d],M=null!=g.key,b=g.MIX_DOM_DEF,_=g.getRemote||v[b]||g.tag;let N=!1,P=null;if(D)for(const t of D)if((M?t.key===g.key:null==t.key)&&_===(t.getRemote||v[t.MIX_DOM_DEF]||t.tag)&&r.has(t)&&('boundary'!==b||!(null===(f=null===(c=null===(l=t.treeNode)||void 0===l?void 0:l.boundary)||void 0===c?void 0:c.component)||void 0===f?void 0:f.constantProps)||e.areEqualBy(g.props,t.props,t.treeNode.boundary.component.constantProps))){P=t,r.delete(t),P.updateId&&P.updateId!==a&&delete P.updateId;break}if(!P&&M&&y){const t=o&&o.get(_);if(t)for(const n of t)if(n.key===g.key&&r.has(n)&&('boundary'!==b||!(null===(m=null===(h=null===(p=n.treeNode)||void 0===p?void 0:p.boundary)||void 0===h?void 0:h.component)||void 0===m?void 0:m.constantProps)||e.areEqualBy(g.props,n.props,n.treeNode.boundary.component.constantProps))){P=n,r.delete(n),N=!0;for(const e of s(P))e.updateId=a;break}}P?P.action=N||!t||t.childDefs[d]!==P?'moved':'updated':P=u(g,i&&i.closure||null),C.push(P)}return C}function P(e,t=!1,n=new Set,o){const s=new Map;let r,i=t?e.childDefs.slice():[e],d=0;for(;r=i[d];){d++,n.add(r);const e=r.getRemote||v[r.MIX_DOM_DEF]||r.tag,t=s.get(e);if(t?t.push(r):s.set(e,[r]),r.scopeType)if('spread-pass'===r.scopeType)o&&o.push(r);else{const e=[];r.scopeMap=P(r,!0,n,e)[0],e[0]&&(i=e[0].childDefs.concat(i.slice(d)),d=0)}else r.childDefs[0]&&(i=r.childDefs.concat(i.slice(d)),d=0)}return[s,n]}class O{constructor(e,t,n){this.host=e,this.treeNode=n,this._outerDef=t,this._innerDef=null,this.isMounted=!1,this.sourceBoundary=null,this.parentBoundary=null,this.innerBoundaries=[]}}class w extends O{constructor(e,t,n,o){super(o.host,e,n),this.sourceBoundary=o,this.targetDef=t,this._innerDef=u(t,o.closure)}updateEnvelope(e,t){this.targetDef=e,t&&(this._innerDef.childDefs=t.childDefs)}}class x{constructor(e,t){this.thruBoundary=e||null,this.sourceBoundary=t||null,this.envelope=null,this.truePassDef=null,this.groundedDefs=new Map,this.pendingDefs=new Set}hasContent(){var e;return!(!(null===(e=this.envelope)||void 0===e?void 0:e.applied)||!p(this.envelope.applied.childDefs,!1))}readContent(e=!1){if(!this.envelope)return null;const t=this.envelope.applied,n=t.childDefs;if('fragment'===t.MIX_DOM_DEF&&(!n.length||n[0].disabled&&1===n.length))return null;const o=this.envelope.target.childDefs;return e?o.slice():o}}class I extends e.ContextAPI{getContext(e,t=!0){return void 0!==this.contexts[e]?this.contexts[e]:t?this.host.contextAPI.contexts[e]:void 0}getContexts(e,t=!0,n=!1){return t?Object.assign(Object.assign({},this.host.contextAPI.getContexts(e,n)),super.getContexts(e,n)):super.getContexts(e,n)}afterRefresh(e,t,n){return e?(this.host.triggerRefresh(t,n),this.awaitDelay()):this.host.afterRefresh(!1,t,n)}awaitDelay(){return this.host.afterRefresh(!0)}}function S(t){var o;return(o=class extends(e.mixinSignalMan(t)){constructor(e,t,...n){super(...n),this.props=e,t&&(this.boundary=t,t.component=this)}initContextAPI(){if(this.contextAPI)return;this.contextAPI=new I,this.contextAPI.host=this.boundary.host,this.boundary.host.contextComponents.add(this);const e=this.boundary._outerDef.attachedContexts;if(e)for(const t in e)this.contextAPI.setContext(t,e[t],!1)}isMounted(){return!0===this.boundary.isMounted}getLastState(e=!0){return this._lastState||e&&this.state||null}getHost(){return this.boundary.host}queryElement(e,t=!1,n=!1){return r(this.boundary.treeNode,e,t,n)}queryElements(e,t=0,n=!1,o=!1){return i(this.boundary.treeNode,e,t,n,o)}findElements(e=0,t=!1,o=!1,s){return n(this.boundary.treeNode,new Set(['dom']),e,t,o,s).map((e=>e.domNode))}findComponents(e=0,t=!1,o=!1,s){return n(this.boundary.treeNode,new Set(['boundary']),e,t,o,s).map((e=>e.boundary&&e.boundary.component))}findTreeNodes(e,t=0,o=!1,s=!1,r){const i=e?e.constructor===Set?e:e.constructor===Array?new Set(e):new Set(Object.keys(e)):void 0;return n(this.boundary.treeNode,i,t,o,s,r)}setTimer(e,t,n){return null==e&&(e={}),this.timers?this.timers.has(e)&&this.clearTimers(e):this.timers=new Map,this.timers.set(e,setTimeout((()=>{this.clearTimers(e),t.call(this)}),n)),e}hasTimer(e){return!!this.timers&&this.timers.has(e)}clearTimers(...e){if(this.timers)if(e.length)for(const t of e){const e=this.timers.get(t);null!=e&&(clearTimeout(e),this.timers.delete(t))}else this.timers.forEach((e=>clearTimeout(e))),this.timers.clear()}setUpdateModes(e,t=!0){t&&this.updateModes||(this.updateModes={});for(const t in e)this.updateModes[t]=e[t]}setConstantProps(e,t=!0,n=null){var o,s;t&&this.constantProps||(this.constantProps={});let r=!1;if(e)if(Array.isArray(e))for(const t of e)this.constantProps[t]=null===(o=(r=!0)&&n)||void 0===o||o;else for(const t in e)this.constantProps[t]=null!==(s=(r=!0)&&n)&&void 0!==s?s:e[t];r||t||delete this.constantProps}setState(e,t,n,o){this.boundary.updateBy({state:Object.assign(Object.assign({},this.state),e)},t,n,o)}setInState(e,t,n,o,s){this.boundary.updateBy({state:Object.assign(Object.assign({},this.state),{[e]:t})},n,o,s)}triggerUpdate(e,t,n){this.boundary.host.services.absorbUpdates(this.boundary,{force:e||!1},!0,t,n)}addWired(e){this.wired?this.wired.add(e):this.wired=new Set([e])}removeWired(e){var t;null===(t=this.wired)||void 0===t||t.delete(e)}afterRefresh(e=!1,t,n){return this.boundary.host.afterRefresh(e,t,n)}render(e,t){return null}}).MIX_DOM_CLASS='Component',o}class R extends(S(Object)){}function T(e,t=e.name){return{[t]:e.length>1?(t,n,o)=>e(n,o):(t,n)=>e(n)}[t]}R.MIX_DOM_CLASS='Component';const E=(e,t=e.name)=>({[t]:(t,n,o)=>e(n,o)}[t]);class B extends O{constructor(e,t,n,o){super(e,t,n),this.bId=e.services.createBoundaryId(),this.sourceBoundary=o||null,this.closure=new x(this,o)}reattach(){this.component=null;const t=this._outerDef.props||{};let n=this._outerDef.tag;if('function'==typeof n){const o=n.api,s=n.MIX_DOM_CLASS?null:this._outerDef.tag,r=s&&s.length>=3||!1,i=this.component=new(s?o?{[s.name]:class extends R{}}[s.name]:R:n)(t,this);if(this.component=i,r&&i.initContextAPI(),s&&(i.render=r?e=>s.call(i,e,i,i.contextAPI):e=>s.call(i,e,i)),i.boundary||(i.boundary=this),o){i.constructor.api=o,o.components.add(i);for(const e in o.signals)for(const t of o.signals[e]){const[n,o,s]=t;i.listenTo(e,((...e)=>o?n(i,...e,...o):n(i,...e)),null,s,n)}}'Remote'===n.MIX_DOM_CLASS&&(this.closure.remote=i,n.addSource(i)),i.signals.preMount&&e.callListeners(i.signals.preMount)}else this.component=new R(t,this)}update(e,t,n){this.host.services.absorbUpdates(this,{force:this.isMounted?e||!1:'all'},!0,t,n)}updateBy(e,t,n,o){this.host.services.absorbUpdates(this,Object.assign(Object.assign({},e),{force:this.isMounted?t||!1:'all'}),!0,n,o)}render(e=0){const t=!1===this.isMounted&&!this._renderState;e||(this._renderState='active');const n=this.component,o=n.render(n.props||{},n.state),s='function'==typeof o;if(s&&(n.render=o),t&&n.contextAPI&&n.contextAPI.callDataBy(),s)return this.render(e);if('re-updated'===this._renderState){const t=this.host.settings;if(t.maxReRenders<0||e<t.maxReRenders)return e++,this._renderState='active',this.render(e);t.devLogWarnings&&console.warn('__SourceBoundary.render: Warning: The component tried to render for over '+(e+1).toString()+' times.',this._outerDef.tag.MIX_DOM_CLASS?n.constructor:this._outerDef.tag,n)}return delete this._renderState,o}}function A(e,t=!1){const[n,o,s]=function(e){const t=e._innerDef,n=e.sourceBoundary,o=[],s=[],r=[];let i,d=[[e.targetDef,t,e.treeNode,!1]],a=0;for(;i=d[a];){a++;const[e,t,l,c]=i;if(t.childDefs[0]){const r=l&&'boundary'!==e.MIX_DOM_DEF&&('element'!==e.MIX_DOM_DEF||e.domElement)?_(t.childDefs,l,c,n,s):[];let i=0;const u=[];for(const n of t.childDefs){const t=r[i]||null;!t&&n.treeNode&&(o.push(n.treeNode),n.treeNode.sourceBoundary=null),u.push([e.childDefs[i],n,t,'fragment'===n.MIX_DOM_DEF]),i++}d=u.concat(d.slice(a)),a=0}l&&!t.disabled&&r.push([e,t,l])}return[r,o,s]}(e);let[r,i]=F(e,n,t);if(o[0]){const e=new Set;for(const t of o)t.sourceBoundary||(t.def&&e.add(t.def),t.parent=null);if(e.size){const t=X(e);r=t[0].concat(r),i=t[1].concat(i)}}return s[0]&&(r=s.map((e=>({treeNode:e,emptyMove:!0}))).concat(r)),e.isMounted=!0,[r,i]}function k(e,t=!1){let n,o,s=null,r=e._innerDef;e.bId?(s=c(e.render()),s&&!r&&(r=u(s,e.closure))):s=e.targetDef;const[i,d]=r?P(r):[new Map,new Set],a=[];if(s){const l=[],c=function(e,t,n,o,s,r,i){const d=e.host.settings,a=d.noRenderValuesMode,l=d.wideKeysInArrays,c=[],u=e.bId?e:e.sourceBoundary;let f,p=[[{childDefs:[t]},{childDefs:[n]},e.treeNode,!1,null]],h=0;for(;f=p[h];){h++;const[t,n,d,m]=f,g='spread-pass'===n.scopeType?void 0:n.scopeMap||f[5];if(t.childDefs[0]){const c=N(n,t,g||o,s,u,l,e.host.services._whileUpdating);n.childDefs=c;for(let e,o=0;e=t.childDefs[o];o++)if('content'===e.MIX_DOM_DEF){const t=n.childDefs[o];a&&(!0===a?!e.domContent:-1!==a.indexOf(e.domContent))?t.disabled=!0:delete t.disabled}const y='boundary'===t.MIX_DOM_DEF,D=f[4]||y&&n;y&&delete n.hasPassWithin;const C=!d||y||'element'===t.MIX_DOM_DEF&&!t.domElement?[]:_(c,d,m,u,i),M=[];for(let e,n=0;e=t.childDefs[n];n++){const t=C[n]||null,o=c[n];!t&&o.treeNode&&(o.treeNode.sourceBoundary=null,r&&r.push(o)),D&&'pass'===e.MIX_DOM_DEF&&(D.hasPassWithin=!0);const s=[e,o,t,'fragment'===e.MIX_DOM_DEF,D||'boundary'===e.MIX_DOM_DEF&&o||null];M.push(s),g&&(s[5]=g)}p=M.concat(p.slice(h)),h=0}else n.childDefs=[];d&&t.MIX_DOM_DEF&&n.MIX_DOM_DEF&&c.push([t,n,d])}return c}(e,s,r,i,d,l,a);if(e._innerDef=c[0][1],[n,o]=F(e,c,t),l[0])for(const e of l){const t=e.treeNode;t&&null===t.sourceBoundary&&d.add(e)}}else n=[],o=[],!r&&e.isMounted||a.push(e.treeNode),e.innerBoundaries=[],e.treeNode.children=[],e._innerDef=null;if(d.size){const e=X(d);n=e[0].concat(n),o=e[1].concat(o)}return a[0]&&(n=a.map((e=>({treeNode:e,emptyMove:!0}))).concat(n)),e.isMounted||(e.isMounted=!0),[n,o]}function F(e,n,s=!1){var r,i;const d=e.bId?e:e.sourceBoundary,a=[],l=e.host.settings.preCompareDOMProps;e.innerBoundaries=[];let c=[[],[]];for(const u of n){const[n,f,p]=u,m='mounted'===f.action;if(!m&&'moved'===f.action)switch(f.MIX_DOM_DEF){case'fragment':for(const e of o(p,!0,!0))-1===a.indexOf(e)&&(a.push(e),c[0].push({treeNode:e,move:!0}));break;case'host':f.host&&f.host.groundedTree.parent===p&&c[0].push({treeNode:p,move:!0})}if('fragment'===f.MIX_DOM_DEF)continue;if('pass'===p.type){if('pass'!==f.MIX_DOM_DEF)continue;let t=h.key;if(f.getRemote){const n=f.getRemote();t=null===(r=n.Content)||void 0===r?void 0:r.key,D(c,j(n.closure,f,e,p,f.key!==t?f.key:null))}else f.contentPass&&D(c,j(f.contentPass,f,e,p,f.key!==t?f.key:null));p.boundary&&e.innerBoundaries.push(p.boundary);continue}const y=f.props;let C=!1;n.props&&(p.boundary&&(p.boundary._outerDef.props=n.props),f.props=n.props||{});let M=!1;switch(f.MIX_DOM_DEF){case'content':M=!0;const t=n.domHTMLMode;C=f.domContent!==n.domContent||t!==n.domHTMLMode,C&&(f.domContent=n.domContent,void 0!==t?f.domHTMLMode=t:delete f.domHTMLMode);break;case'element':M=!0,f.domElement!==n.domElement&&(m||c[0].push({treeNode:p,swap:!0}),f.domElement=n.domElement||null),f.domCloneMode=null!=n.domCloneMode?n.domCloneMode:null;break;case'dom':M=!0;break;case'portal':f.domPortal!==n.domPortal&&(c[0].push({treeNode:p,[m?'create':'swap']:!0}),f.domPortal=n.domPortal||null);break;case'boundary':if(m){n.attachedContexts&&(f.attachedContexts=n.attachedContexts);const t=new B(e.host,f,p,d);t.parentBoundary=e,p.boundary=t}break;case'host':if(f.host){const e=f.host;let t=e;if('mounted'===f.action){if(e.groundedTree.parent){const n=t.settings.duplicatableHost;if('function'==typeof n){const e=n(f.host,p);if(!e)break;if('object'==typeof e){if(e.groundedTree.parent)break;t=e}}else if(!n)break;const o=e.shadowAPI;t===e?t=new e.constructor(e.services.getRootDef(!0),null,e.settings,null,o):t.shadowAPI!==e.shadowAPI&&(t.shadowAPI.hosts.delete(t),t.shadowAPI=e.shadowAPI);for(const e in o.contexts){const n=o.contexts[e];n&&t.contextAPI.setContext(e,n,!1)}f.host=t}e.shadowAPI.hosts.add(t)}t.groundedTree.parent=p,p.children=[t.groundedTree],c[0].push({treeNode:p,move:!0});break}}if(M){if(m)c[0].push({treeNode:p,create:!0});else{const e='moved'===f.action&&-1===a.indexOf(p),o=!!f.tag&&(!l||'if-needed'===l&&(C||e)||!t.equalDOMProps(y||{},n.props||{}));if(o||C||e){const t={treeNode:p};o&&(t.update=!0),C&&(t.content=!0),e&&(t.move=!0,a.push(p)),c[0].push(t)}}f.attachedSignals!==n.attachedSignals&&(n.attachedSignals?f.attachedSignals=n.attachedSignals:delete f.attachedSignals)}if(p.boundary){const o=p.boundary;if(e.innerBoundaries.push(o),m){if(f.tag&&f.tag._WithContent){const e=f.tag._WithContent,t=e.getRemote?e.getRemote().closure:d.closure;(t.withContents||(t.withContents=new Set)).add(o)}o.reattach()}const r=o.component;if(f.attachedSignals!==n.attachedSignals){const e=t.getDictionaryDiffs(f.attachedSignals||{},n.attachedSignals||{});if(e)for(const t in e)e[t]?r.listenTo(t,e[t]):r.unlistenTo(t,f.attachedSignals[t]);f.attachedSignals=n.attachedSignals}if(f.attachedContexts!==n.attachedContexts){if(r.contextAPI){const e=t.getDictionaryDiffs(f.attachedSignals||{},n.attachedSignals||{});if(e){for(const t in e)e[t]?r.contextAPI.setContext(t,e[t]):r.contextAPI.setContext(t,null);r.contextAPI.callDataBy(m||Object.keys(e))}}f.attachedContexts=n.attachedContexts}let l=null;const u=o.closure.envelope;n.childDefs[0]&&(l=u?{applied:Object.assign(Object.assign({},u.applied),{childDefs:f.childDefs,action:f.action}),target:Object.assign(Object.assign({},u.target),{childDefs:n.childDefs})}:{applied:{tag:null,MIX_DOM_DEF:'fragment',childDefs:f.childDefs,action:'mounted'},target:{tag:null,MIX_DOM_DEF:'fragment',childDefs:n.childDefs}});const h=u||l?o.closure:null;let g=null;if(h){g=W(h,l);const e=d.closure;f.hasPassWithin?(e.chainedClosures||(e.chainedClosures=new Set)).add(h):null===(i=e.chainedClosures)||void 0===i||i.delete(h)}D(c,e.host.services.updateBoundary(o,s,a,g)),h&&D(c,H(h,s))}if(f.attachedRefs||n.attachedRefs){const e=f.attachedRefs,t=n.attachedRefs;if(e)for(const n of e)t&&t.includes(n)||g.willDetachFrom(n,p);if(t)for(const n of t)e&&e.includes(n)||g.didAttachOn(n,p);f.attachedRefs=t}}return c}function X(e,t=!0,n=!0){var o,s;let r=[[],[]];for(const i of e){const e=i.treeNode;if(e){switch(i.MIX_DOM_DEF){case'dom':case'element':case'content':n&&r[0].push({treeNode:e,remove:!0});break;case'boundary':e.boundary&&D(r,L(e.boundary,!1,n));break;case'pass':(i.contentPass||i.getRemote)&&D(r,U(i.contentPass||i.getRemote().closure,i));case'host':{const t=i.host;if(t&&t.groundedTree.parent===e){t.groundedTree.parent=null,e.children=[],r[0].push({treeNode:e,move:!0}),t.shadowAPI.hosts.delete(t);const n=t.contextAPI;for(const e in n.contexts)null===(o=n.contexts[e])||void 0===o||o.contextAPIs.delete(n)}}default:if(i.attachedRefs&&i.MIX_DOM_DEF)for(const t of i.attachedRefs)g.willDetachFrom(t,e)}t&&('pass'===(null===(s=e.parent)||void 0===s?void 0:s.type)&&e.parent.def.getRemote&&r[0].push({emptyMove:!0,treeNode:e.parent}),e.parent=null,e.sourceBoundary=null,delete i.treeNode)}}return r}function L(t,n=!0,r=!0){var i,d,a,l;let c=[[],[]];if(null===t.isMounted)return c;const u=t.bId?t:null;if(u){const t=u.component,n=t.constructor;t.signals.willUnmount&&e.callListeners(t.signals.willUnmount);const o=u._outerDef;if(o.attachedRefs)for(const e of o.attachedRefs)g.willDetachFrom(e,u.treeNode);null===(d=null===(i=u.sourceBoundary)||void 0===i?void 0:i.closure.chainedClosures)||void 0===d||d.delete(u.closure);const s=t.contextAPI;if(s){for(const e in s.contexts)null===(a=s.contexts[e])||void 0===a||a.contextAPIs.delete(s);s.contexts={},u.host.contextComponents.delete(t)}if(n.api&&(n.api.components.delete(t),n.api.signals&&(n.api.signals={})),'Remote'===n.MIX_DOM_CLASS&&D(c,n.removeSource(t)),o.tag._WithContent){const e=o.tag._WithContent,t=e.getRemote?e.getRemote().closure:null===(l=u.sourceBoundary)||void 0===l?void 0:l.closure;(null==t?void 0:t.withContents)&&(t.withContents.delete(u),t.withContents.size||delete t.withContents)}t.signals&&(t.signals={}),t.timers&&t.clearTimers()}return r&&(c[0]=c[0].concat(o(t.treeNode,!0).map((e=>({treeNode:e,remove:!0}))))),t._innerDef&&D(c,X(s(t._innerDef,!0),n,!1)),u&&u.host.services.cancelUpdates(u),t.isMounted=null,c}function j(e,t,n,s,r){return e.groundedDefs.get(t)?'moved'===t.action&&s.boundary?[o(s.boundary.treeNode,!0,!0).map((e=>({treeNode:e,move:!0}))),[]]:[[],[]]:(e.groundedDefs.set(t,[n,s,r]),z(e,[t]))}function U(e,t){const n=e.groundedDefs.get(t);if(!n)return[[],[]];e.groundedDefs.delete(t),e.pendingDefs.delete(t),e.truePassDef===t&&(e.truePassDef=null);const o=n[1].boundary;return o?L(o):[[],[]]}function W(e,t,n){if(e.remote)return e.envelope=t,W(e.remote.closure,t,e.remote);if(!e.envelope&&!t)return null;const o=b(e,n);if(o)for(const e of o)e._forceUpdate=e._forceUpdate||!0;return e.envelope=t,e.pendingDefs=new Set(e.groundedDefs.keys()),o}function H(e,t=!1){if(e.remote)return H(e.remote.closure,t);let n=[],o=[];return e.pendingDefs.size&&([n,o]=z(e,e.pendingDefs,t)),[n,o]}function z(e,t,n=!1){let o=[],s=[];for(const r of t){e.pendingDefs.delete(r);const t=e.groundedDefs.get(r);if(void 0===t)continue;let[i,d,a]=t,l=d.boundary;if(e.envelope&&e.sourceBoundary){let t=!0;const c=e.envelope;l?(t=e.truePassDef===r,l.updateEnvelope(c.target,t?c.applied:null)):(l=new w(r,c.target,d,e.sourceBoundary),t=null==a&&(!e.truePassDef||e.truePassDef===r),t&&(l._innerDef.childDefs=c.applied.childDefs,e.truePassDef=r),l.parentBoundary=i,d.boundary=l);const[u,f]=t?A(l,n):k(l,n);o=o.concat(u),s=s.concat(f)}else if(l){const e=L(l,!1);o=o.concat(e[0]),s=s.concat(e[1]),d.boundary=null}}return[o,s]}class q{constructor(t){this.host=t,this.bIdCount=0,this.renderer=new y(t.settings,t.groundedTree),this.updateCycle=new e.RefreshCycle((()=>({updates:new Set}))),this.renderCycle=new e.RefreshCycle((()=>({rCalls:[],rInfos:[]}))),this.constructor.initializeCyclesFor(this)}createBoundaryId(){return'h-'+this.host.constructor.idCount.toString()+':b-'+(this.bIdCount++).toString()}clearTimers(e=!1){e||(this.updateCycle.resolve(),this.renderCycle.resolve()),this.updateCycle.reject(),this.renderCycle.reject()}createRoot(e){return this.rootDef=c(e),(e,t)=>()=>this._rootDisabled?null:this.rootDef}updateRoot(e,t,n){this.rootDef=c(e),this.host.rootBoundary.update(!0,t,n)}refreshRoot(e=!1,t,n){const s=!this._rootDisabled,r=this.host,i=!(r.settings.onlyRunInContainer&&!r.groundedTree.domNode&&!r.groundedTree.parent);if(i?delete this._rootDisabled:this._rootDisabled=!0,!e&&i&&s){if(i&&s){const e=r.rootBoundary?o(r.rootBoundary.treeNode,!0).map((e=>({treeNode:e,move:!0}))):[];this.absorbChanges(e,null,n)}}else r.rootBoundary.update(!0,t,n)}clearRoot(e=!1){this.clearTimers(e),this.rootDef=null}getRootDef(e){return this.rootDef&&(e?Object.assign({},this.rootDef):this.rootDef)}hasPending(e=!0,t=!0){return!!(e&&this.updateCycle.state||t&&this.renderCycle.state)}addRefreshCall(e,t=!1){t?this.renderCycle.promise.then(e):this.updateCycle.promise.then(e)}cancelUpdates(e){var t;null===(t=this.updateCycle.pending.updates)||void 0===t||t.delete(e)}absorbUpdates(e,t,n=!0,o,s){if(null!==e.isMounted){if(t.force&&(e._forceUpdate='all'===e._forceUpdate?'all':t.force),t.props&&(e._outerDef.props=t.props),t.state){const n=e.component;n._lastState||(n._lastState=Object.assign({},n.state)),n.state=t.state}e._renderState?e._renderState='re-updated':(this.updateCycle.pending.updates.add(e),n&&this.triggerRefresh(o,s))}}triggerRefresh(e,t){this.updateRefreshTimes(e,t),this.updateCycle.trigger(this.host.settings.updateTimeout)}updateRefreshTimes(e,t){void 0!==t&&this.renderCycle.extend(t),void 0!==e&&this.updateCycle.extend(e)}updateBoundary(t,n=!1,s,r){let i=!!n,d='all'===n,a=[],l=[];const c=t.component,u=!t.isMounted;if(u){if(null===t.isMounted)return null;l.push([t,'mounted']),i=!0}const f=t._outerDef.props!==c.props?c.props||{}:void 0;f&&(c.props=t._outerDef.props);const p=c.constructor.api;if(p&&(u||f)&&(u&&p.onBuildProps&&!p.builtProps&&(p.builtProps=p.onBuildProps(null)),p.getMixedProps&&(u||c._lastState||(c._lastState=Object.assign({},c.state)),c.state=p.getMixedProps(c))),!u&&c.signals.beforeUpdate&&e.callListeners(c.signals.beforeUpdate),t._forceUpdate&&('all'===t._forceUpdate&&(d=!0),i=!0,delete t._forceUpdate),!u){const n=c._lastState;if(delete c._lastState,i||f||n){if(!i){const o=c.signals.shouldUpdate?e.askListeners(c.signals.shouldUpdate,[c,f,n],['first-true','no-false']):null;(!0===o||null==o&&q.shouldUpdateBy(t,f,n))&&(i=!0)}const r='moved'===t._outerDef.action;if(r&&l.push([t,'moved']),i&&l.push([t,'updated',f,n]),r)for(const e of o(t.treeNode,!0,!0)){if(s){if(-1!==s.indexOf(e))continue;s.push(e)}a.push({treeNode:e,move:!0})}c.signals.preUpdate&&e.callListeners(c.signals.preUpdate,[f,n,i])}}if(i){const[e,n]=k(t,d);a=a.concat(e),l=l.concat(n)}if(c.wired)for(const e of c.wired){if(e.api.onBuildProps){const t=e.api.builtProps;if(e.api.builtProps=e.api.onBuildProps(t),t===e.api.builtProps)continue}if(e.api.components.size){r||(r=new Set);for(const t of e.api.components)t.boundary._outerDef.props=Object.assign({},t.boundary._outerDef.props),r.add(t.boundary)}}if(r&&r.size){for(const e of r)e.sourceBoundary===t.sourceBoundary&&e._updateId!==t.host.services._whileUpdating&&(e._forceUpdate=!0,r.delete(e));const e=M(r,!0);a=a.concat(e[0]),l=l.concat(e[1])}return a[0]||l[0]?[a,l]:null}absorbChanges(e,t,n){var o;e&&this.renderCycle.pending.rInfos.push(e),t&&(this.host.settings.useImmediateCalls?q.callBoundariesBy(t):this.renderCycle.pending.rCalls.push(t)),this.renderCycle.trigger(null!==(o=this.host.settings.renderTimeout)&&void 0!==o?o:void 0,null!=n?n:void 0)}static initializeCyclesFor(e){e.updateCycle.listenTo('onRefresh',((t,n)=>e.constructor.runUpdates(e,t,n))),e.renderCycle.listenTo('onRefresh',((t,n)=>e.constructor.runRenders(e,t,n))),e.updateCycle.listenTo('onFinish',(()=>{e.renderCycle.trigger(e.host.settings.renderTimeout)})),e.renderCycle.listenTo('onStart',(()=>e.updateCycle.trigger(e.host.settings.updateTimeout))),e.renderCycle.listenTo('onResolve',(()=>e.updateCycle.resolve()))}static runUpdates(e,t,n){if(!e._whileUpdating){for(;t.updates.size;){e._whileUpdating={};let n=[],o=[];for(const s of t.updates.size>1?C(t.updates):[...t.updates]){s._updateId=e._whileUpdating;const t=e.updateBoundary(s);t&&(n=n.concat(t[0]),o=o.concat(t[1]))}n[0]&&e.renderCycle.pending.rInfos.push(n),o[0]&&(e.host.settings.useImmediateCalls?q.callBoundariesBy(o):e.renderCycle.pending.rCalls.push(o)),t=e.updateCycle.resetPending()}delete e._whileUpdating}}static runRenders(e,t,n){if(t.rInfos)for(const n of t.rInfos)n[0]&&e.renderer.applyToDOM(n);if(t.rCalls)for(const e of t.rCalls)e[0]&&q.callBoundariesBy(e)}static shouldUpdateBy(t,n,o){var s,r,i;const d=t.component,a=t.host.settings.updateComponentModes,l=null===(s=d.constructor.api)||void 0===s?void 0:s.updateModes,c=n&&o?['props','state']:n?['props']:o?['state']:[];for(const t of c){const s=null!==(i=null!==(r=d.updateModes&&d.updateModes[t])&&void 0!==r?r:l&&l[t])&&void 0!==i?i:a[t],c='number'==typeof s?s:e.CompareDataDepthEnum[s]||0;if(c<-1){if(-2===c)return!0}else{if(0===c)return!0;if(!e.areEqual('state'===t?o:n,d[t],c))return!0}}return!1}static callBoundariesBy(t){for(const n of t){const[t,o,s,r]=n,i=t.component,d='mounted'===o?'didMount':'moved'===o?'didMove':'didUpdate';i.signals[d]&&e.callListeners(i.signals[d],'updated'===o?[s,r]:void 0)}}}class K{constructor(){this.hosts=new Set,this.contexts={}}}class G extends e.ContextAPI{setContext(e,t,n=!0,o=!1){return o&&(t?this.host.shadowAPI.contexts[e]=t:delete this.host.shadowAPI.contexts[e]),super.setContext(e,t,n)}setContexts(e,t=!0,n=!1){if(n){const t=this.host.shadowAPI.contexts;for(const n in e)e[n]?t[n]=e[n]:delete t[n]}return super.setContexts(e,t)}awaitDelay(){return this.host.services.renderCycle.promise}afterRefresh(e,t,n){return this.host.services.triggerRefresh(t,n),e?this.awaitDelay():this.host.services.updateCycle.promise}static getListenersFor(e,t,n){const o=t+'.'+(n||''),s=[...e.host.contextComponents];if(!n){let n=[];for(const t in e.signals)t.startsWith(o)&&(n=n.concat(e.signals[t]));return n.concat(s.reduce(((e,n)=>{if(void 0!==n.contextAPI.contexts[t])return e;const s=n.contextAPI.signals;for(const t in s)t.startsWith(o)&&(e=e.concat(s[t]));return e}),[]))}const r=(e.signals[o]||[]).concat(s.filter((e=>e.contextAPI.signals[o]&&void 0===e.contextAPI.contexts[t])).map((e=>e.contextAPI.signals[o])).reduce(((e,t)=>e.concat(t)),[]));return r[0]&&r}static callDataListenersFor(t,n=!0){if(t.callDataBy(n,!0),t.host.contextComponents.size){const o=e.ContextAPI.readContextNamesFrom(!0===n?Object.keys(t.contexts):n);for(const e of t.host.contextComponents)o.some((t=>void 0===e.contextAPI.contexts[t]))&&e.contextAPI.callDataBy(n)}}}class V{constructor(e,t,n,o,s){this.constructor.idCount++,this.shadowAPI=s||new K,this.contextComponents=new Set,this.contextAPI=new G,this.contextAPI.host=this,o&&this.contextAPI.setContexts(o,!1,!0),this.groundedTree={type:'root',parent:null,children:[],domNode:t||null,sourceBoundary:null},this.settings=V.getDefaultSettings(),n&&V.modifySettings(this.settings,n),this.services=new q(this);const r=u({MIX_DOM_DEF:'boundary',tag:this.services.createRoot(e),props:{},childDefs:[]},null),i={type:'boundary',def:r,sourceBoundary:null,boundary:null,parent:this.groundedTree,children:[],domNode:null};this.groundedTree.children.push(i),this.rootBoundary=new B(this,r,i),i.boundary=this.rootBoundary,this.rootBoundary.reattach(),this.services.absorbUpdates(this.rootBoundary,{})}clearRoot(e=!0,t,n){this.services.clearRoot(!0),e&&this.rootBoundary.update(!0,t,n)}moveRoot(e,t){if(this.groundedTree.domNode===e)return;this.groundedTree.domNode=e;const n=o(this.rootBoundary.treeNode,!0).map((e=>({treeNode:e,move:!0})));(n[0]||void 0!==t)&&this.services.absorbChanges(n,null,t)}updateRoot(e,t,n){this.services.updateRoot(e,t,n)}refreshRoot(e=!1,t,n){this.services.refreshRoot(e,t,n)}refreshDOM(e=!1,t){const n=!e||'read',o=[];let s,r=[...this.groundedTree.children],i=0;for(;s=r[i];)i+=1,s.domProps&&o.push({treeNode:s,refresh:n}),s.children[0]&&(r=s.children.concat(r.slice(i)),i=0);this.services.absorbChanges(o,null,t)}afterRefresh(e=!1,t,n){return new Promise((o=>this.afterRefreshCall(o,e,t,n)))}updateRefreshTimes(e,t){this.services.updateRefreshTimes(e,t)}afterRefreshCall(e,t=!1,n,o){this.services.hasPending(!0,t)?(this.addRefreshCall(e,t),this.services.triggerRefresh(n,o)):e()}addRefreshCall(e,t=!1){this.services.addRefreshCall(e,t)}triggerRefresh(e,t){this.services.triggerRefresh(e,t)}pause(){this.services.renderer.pause()}resume(){this.services.renderer.resume()}isPaused(){return this.services.renderer.paused}rehydrate(e=null,t=!1,n=!1,o=!1,s,r){this.services.renderer.rehydrate(e||this.groundedTree.domNode,t,n,o,s,r)}rehydrateWith(e,t=null,n=!1,o=!1,s=!1,r,i){this.pause(),this.updateRoot(e,null,null),this.services.renderer.rehydrate(t||this.groundedTree.domNode,n,o,s,r,i)}readAsString(){return t.readAsString(this.rootBoundary.treeNode)}getRootElement(){return this.rootBoundary&&this.rootBoundary.treeNode.domNode}getRootElements(e){return this.rootBoundary?o(this.rootBoundary.treeNode,e,!1).map((e=>e.domNode)):[]}queryElement(e,t=!1){return r(this.groundedTree,e,!0,t)}queryElements(e,t=0,n=!1){return i(this.groundedTree,e,t,!0,n)}findElements(e=0,t=!1,o){return n(this.groundedTree,new Set(['dom']),e,!0,t,o).map((e=>e.domNode))}findComponents(e=0,t=!1,o){return n(this.groundedTree,new Set(['boundary']),e,!0,t,o).map((e=>e.boundary&&e.boundary.component))}findTreeNodes(e,t=0,o=!1,s){const r=e.constructor===Set?e:e.constructor===Array?new Set(e):new Set(Object.keys(e));return n(this.groundedTree,r,t,!0,o,s)}modifySettings(e,t=!0){const n=this.settings.onlyRunInContainer;if(V.modifySettings(this.settings,e),void 0!==e.onlyRunInContainer&&e.onlyRunInContainer!==n&&this.refreshRoot(!1,null,null),t)for(const t of this.shadowAPI.hosts)t!==this&&t.modifySettings(e,!1)}static modifySettings(e,t,n=!1){var o;let s=null;if(t.updateComponentModes){const e=t.updateComponentModes,n={};for(const t in e)n[t]=null!==(o=e[t])&&void 0!==o?o:(s||(s=V.getDefaultSettings())).updateComponentModes[t];t=Object.assign(Object.assign({},t),{updateComponentModes:n})}for(const o in t)void 0!==t[o]?e[o]=t[o]:n&&(e[o]=(s||(s=V.getDefaultSettings()))[o])}static getDefaultSettings(){return{updateTimeout:0,renderTimeout:0,useImmediateCalls:!1,updateComponentModes:{props:'shallow',state:'shallow'},preCompareDOMProps:'if-needed',wideKeysInArrays:!1,noRenderValuesMode:!1,onlyRunInContainer:!1,disableRendering:!1,duplicateDOMNodeBehaviour:'deep',duplicateDOMNodeHandler:null,duplicatableHost:!1,maxReRenders:1,renderTextTag:'',renderHTMLDefTag:'span',renderTextHandler:null,renderSVGNamespaceURI:'http://www.w3.org/2000/svg',renderDOMPropsOnSwap:!0,devLogWarnings:!1}}}var Y;V.MIX_DOM_CLASS='Host',V.idCount=0;class J{constructor(e){}}J.MIX_DOM_CLASS='Fragment';class Q{constructor(e){}}Q.MIX_DOM_CLASS='Portal';class Z{constructor(e){}}Z.MIX_DOM_CLASS='Element';class ${constructor(e){}render(){return null}}$.MIX_DOM_CLASS='Empty';const ee=((Y=class extends ${static isRemote(){return!1}}).Content=null,Y.ContentCopy=null,Y.copyContent=e=>null,Y.filterContent=(e,t)=>null,Y.wrapContent=(e,t)=>null,Y.renderContent=e=>null,Y.hasContent=e=>!1,Y.WithContent=(e,t)=>null,Y.sources=[],Y);class te extends e.SignalMan{constructor(){super(...arguments),this.components=new Set}update(e=!0,t,n){for(const o of this.components)o.triggerUpdate(e,t,n)}static onListener(e,t,n,o){if(e.components.size){const s=e.signals[t][n],r=s[0];if(o)for(const n of e.components)n.listenTo(t,((...e)=>s[1]?r(n,...e,...s[1]):r(n,...e)),null,s[2],r);else for(const n of e.components)n.unlistenTo(t,r)}}}class ne extends te{constructor(){super(),this.updateModes={props:'never'},this.builtProps=null}buildProps(){return this.onBuildProps?this.onBuildProps(this.builtProps):this.builtProps}getMixedProps(e){return this.onMixProps?this.onMixProps(e.props,this.builtProps,e):Object.assign(Object.assign({},e.props),e.state)}setProps(e,t,n,o){(this.builtProps!==e||t||void 0!==n||void 0!==o)&&(this.builtProps=e,this.update('trigger'!==t&&t,n,o))}refresh(e,t,n){this.setProps(this.buildProps(),e,t,n)}update(e=!0,t,n){for(const o of this.components)o.setState(this.getMixedProps(o),e,t,n)}}var oe;const se=e=>{var t;return!(!(null===(t=e.contentPass)||void 0===t?void 0:t.envelope)||!p(e.contentPass.envelope.applied.childDefs,se))},re=((oe=class extends R{hasContent(){var e;const t=null===(e=this.boundary.sourceBoundary)||void 0===e?void 0:e.closure;return t&&t.envelope&&p(t.envelope.applied.childDefs,se)||!1}render(){var e;return(null!==(e=this.props.hasContent)&&void 0!==e?e:this.hasContent())?h:null}})._WithContent=h,oe);function ie(...e){const t=e.length,n=!0===e[t-1],o=n||!e[t-1]?e.slice(0,t-1):e,s=(e,t,s)=>{let r=null;for(const n of o){if(!n)continue;const o=t.state,i=n(e,t,s);'function'!=typeof i&&'function'==typeof r||(r=i),o!==t.state&&t.state&&(t.state=Object.assign(Object.assign({},o||{}),t.state))}return n?()=>r:r};let r=!1;const i=o.filter((e=>(r=r||e.length>2,e.api))).map((e=>e.api)),d=r?(e,t,n)=>s(e,t,n):(e,t)=>s(e,t);return i[0]&&(d.api=function(e){const t=e.some((e=>e instanceof ne))?new ne:new te;for(const n of e){if(n.updateModes){t.updateModes||(t.updateModes={});for(const e in n.updateModes)t.updateModes[e]=Object.assign(Object.assign({},t.updateModes[e]),n.updateModes[e])}for(const e in n.signals)t.signals[e]=[...t.signals[e]||[],...n.signals[e]];n instanceof ne&&(n.builtProps&&(t.builtProps=n.builtProps),n.onBuildProps&&(t.onBuildProps=n.onBuildProps),n.onMixProps&&(t.onMixProps=n.onMixProps))}return t}(i)),d}function de(...e){const t=e[0].MIX_DOM_CLASS?e[0]:null;let n=t||R;for(const o of t?e.slice(1):e)n=o(n);return n}function ae(e,...t){const n='function'!=typeof t[t.length-1]&&!!t.pop(),o=t.length>1?ie(...t):t[0];return{[e.name]:class extends e{render(e){const t=o(e,this,this.contextAPI);return n?super.render:'function'==typeof t?t:()=>t}}}[e.name]}const le=(t,n)=>new e.Context(t,n),ce={def:l,defHTML:function(e,n,o,s){const r={MIX_DOM_DEF:'content',tag:n||'',childDefs:[],domContent:e,domHTMLMode:!0};return n&&o&&(r.props=t.cleanDOMProps(o)),null!=s&&(r.key=s),r},Content:h,WithContent:re,ContentCopy:m,copyContent:function(e){return f(e,!0)},mixinComponent:S,Component:R,Host:V,Ref:g,Fragment:J,Portal:Q,Element:Z,Empty:$,EmptyRemote:ee,newHost:function(e,t,n,o){return new V(e,t,n,o)},newRef:()=>new g,newContext:le,newContexts:(e,t)=>{const n={};for(const o in e)n[o]=le(e[o],t);return n},component:T,componentCtx:E,shadow:function(e,t,n=e.name){const o=e.MIX_DOM_CLASS?{[n]:class extends e{}}[n]:T(e,n);if(o.api=new te,t)for(const e in t)o.api.listenTo(e,t[e]);return o},shadowCtx:(e,t,n=e.name)=>{const o=E(e,n);if(o.api=new te,t)for(const e in t)o.api.listenTo(e,t[e]);return o},spread:e=>e.length>1?(t,...n)=>e(t,...n):e,spreadWith:e=>e.length>1?(t,...n)=>e(t,...n):e,remote:()=>{var t,n;return t=class t extends R{constructor(){super(...arguments),this.closure=new x(null,this.boundary),this.Content=Object.assign(Object.assign({},f(this)),{contentPass:null,getRemote:()=>this}),this.ContentCopy=Object.assign(Object.assign({},f(this,!0)),{contentPass:null,getRemote:()=>this}),this.copyContent=e=>Object.assign(Object.assign({},f(null!=e?e:t,!0)),{contentPass:null,getRemote:()=>this}),this.hasContent=()=>this.closure.hasContent(),this.WithContent=(()=>{var e;const t=this;return(e=class extends R{render(){return(null!=this.props.hasContent?this.props.hasContent:t.closure.hasContent())?h:null}})._WithContent=t.Content,e})()}render(){return null}static isRemote(){return!0}static addSource(n,o=n.props.order){const s=t.sources.indexOf(n),r=e.orderedIndex(o,t.sources.map((e=>e.props.order)));if(-1===s);else{if(-1===r?s===t.sources.length-1:s===r)return;t.sources.splice(s,1)}-1===r?t.sources.push(n):t.sources.splice(r,0,n);for(const e of t.passers)e.boundary.host===n.boundary.host?e.boundary.update(!0):e.boundary.host.addRefreshCall((()=>e.boundary.update(!0,null,null)),!0)}static removeSource(e){const n=t.sources.indexOf(e);if(-1===n)return null;t.sources.splice(n,1);let o=null;const s=b(e.closure,e);o=function(e,t){const n=W(e,t),o=n&&M(n),s=H(e);return o?[o[0].concat(s[0]),o[1].concat(s[1])]:s}(e.closure,null),e.closure.sourceBoundary=null;for(const n of t.passers)n.boundary.host===e.boundary.host?n.boundary.update(!0):n.boundary.host.addRefreshCall((()=>n.boundary.update(!0,null,null)),!0);return s&&e.boundary.host.addRefreshCall((()=>{for(const e of s)e.update(!0,null,null)}),!0),o}},t.passers=new Set,t.ContentPasser=(e,n)=>(t.passers.add(n),n.listenTo('willUnmount',(()=>t.passers.delete(n))),e=>e.renderer?e.renderer(t.sources.slice()):{tag:null,MIX_DOM_DEF:'fragment',childDefs:e.wrapper?t.sources.map(((t,n)=>e.wrapper?c(e.wrapper(t,n)):null!=e.copyKey?t.copyContent(e.copyKey):e.copy?t.ContentCopy:t.Content)).filter((e=>e)):(e.filterer?t.sources.filter(e.filterer):t.sources).map((t=>null!=e.copyKey?t.copyContent(e.copyKey):e.copy?t.ContentCopy:t.Content))}),t.MIX_DOM_CLASS='Remote',t.Content=l(t.ContentPasser),t.ContentCopy=l(t.ContentPasser,{copy:!0}),t.copyContent=e=>l(t.ContentPasser,{copy:!0,copyKey:e}),t.hasContent=e=>e?t.sources.some(((t,n)=>e(t,n)&&t.closure.hasContent())):t.sources.some((e=>e.closure.hasContent())),t.filterContent=(e,n)=>l(t.ContentPasser,{copyKey:n,filterer:e}),t.wrapContent=(e,n)=>l(t.ContentPasser,{copyKey:n,wrapper:e}),t.renderContent=e=>l(t.ContentPasser,{renderer:e}),t.WithContent=((n=class e extends R{constructor(t,n,...o){super(t,n,...o),e.withContents.add(this.boundary),this.listenTo('willUnmount',(()=>e.withContents.delete(this.boundary)))}render(){return(null!=this.props.hasContent?this.props.hasContent:t.hasContent())?h:null}})._WithContent=t.Content,n.withContents=new Set,n),t.sources=[],t},wired:function(...e){const t=e.length,n='string'==typeof e[t-1]?-1:0,o=e[t-3+n],s=e[t-2+n]||null,r=e[t-1+n],i=n?e[t-1]:r.name,d={[i]:(e,t)=>l(r,Object.assign({},t.state),h)}[i];return d.api=new ne,o&&('object'==typeof o?d.api.builtProps=o:t>2&&'function'==typeof o&&(d.api.onBuildProps=o)),s&&(d.api.onMixProps=s),d},mixin:function(e){return e},mixFuncs:ie,mixFuncsWith:function(...e){const t=e.length;return'function'!=typeof e[t-1]?ie(...e.slice(0,t-1),!0):ie(...e,!0)},mixClassFuncs:ae,mixClassFuncsWith:function(...e){const t=e.length;return ae(...'function'!=typeof e[t-1]?e.slice(0,t-1):e)},mixClassMixins:function(...e){return de(...e)},mixMixins:de,mixMixinsWith:function(...e){const t=e.length;return'function'!=typeof e[t-1]?de(...e.slice(0,t-1)):de(e)},mixHOCs:function(e,...t){let n=e;for(const e of t)n=e(n);return e=>l(n,e,h)},findTreeNodesIn:(e,t,o,s,r,i)=>n(e,t?t.constructor===Set?t:t.constructor===Array?new Set(t):new Set(Object.keys(t)):void 0,o,s,r,i),findComponentsIn:(e,t,o,s,r)=>n(e,new Set(['boundary']),t,o,s,r).map((e=>e.boundary&&e.boundary.component)),findElementsIn:(e,t,o,s,r)=>n(e,new Set(['dom']),t,o,s,r).map((e=>e.domNode)),queryElementIn:(e,t,n,o)=>r(e,t,n,o),queryElementsIn:(e,t,n,o,s)=>i(e,t,n,o,s),readAsString:e=>{const n=e&&(e.constructor.MIX_DOM_CLASS?e.boundary.treeNode:e.treeNode||'string'==typeof e.type&&e);return n?t.readAsString(n):''}};module.exports=ce;
